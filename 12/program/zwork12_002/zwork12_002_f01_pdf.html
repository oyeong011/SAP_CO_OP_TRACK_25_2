<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZWORK12_002_F01_PDF</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZWORK12_002_F01_PDF</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZWORK12_002_F01_PDF<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_DATA .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_DIR_PATH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PDF_FILENAME&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING&nbsp;VALUE&nbsp;'\#####.pdf',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_EXCEL_FILENAME&nbsp;TYPE&nbsp;STRING&nbsp;VALUE&nbsp;'\#####.xlsx',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PDF_FULLPATH&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_EXCEL_FULLPATH&nbsp;TYPE&nbsp;STRING.<br />
<br />
&nbsp;&nbsp;"&nbsp;DOWNLOAD_WEB_OBJECT&nbsp;#&nbsp;RLGRAP&nbsp;##<br />
&nbsp;&nbsp;DATA:&nbsp;LV_EXCEL_RLGRAP&nbsp;&nbsp;&nbsp;TYPE&nbsp;RLGRAP-FILENAME.<br />
&nbsp;&nbsp;DATA:&nbsp;LV_PDF_RLGRAP&nbsp;&nbsp;&nbsp;TYPE&nbsp;RLGRAP-FILENAME.<br />
<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_KEY&nbsp;&nbsp;TYPE&nbsp;WWWDATATAB,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_RC&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_DEST&nbsp;TYPE&nbsp;RLGRAP-FILENAME.<br />
<br />
&nbsp;&nbsp;"1.&nbsp;######<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;GET_TEMP_DIRECTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMP_DIR&nbsp;=&nbsp;LV_DIR_PATH.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'##&nbsp;###&nbsp;#######.'&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;"1-1.&nbsp;####&nbsp;###&nbsp;####&nbsp;###&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;DIRECTORY_BROWSE<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECTED_FOLDER&nbsp;=&nbsp;LV_DIR_PATH.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;Implement&nbsp;suitable&nbsp;error&nbsp;handling&nbsp;here<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CONCATENATE&nbsp;LV_DIR_PATH&nbsp;LV_PDF_FILENAME&nbsp;INTO&nbsp;LV_PDF_FULLPATH.<br />
&nbsp;&nbsp;CONCATENATE&nbsp;LV_DIR_PATH&nbsp;LV_EXCEL_FILENAME&nbsp;INTO&nbsp;LV_EXCEL_FULLPATH.<br />
<br />
&nbsp;&nbsp;LV_EXCEL_RLGRAP&nbsp;=&nbsp;LV_EXCEL_FULLPATH.<br />
&nbsp;&nbsp;LV_PDF_RLGRAP&nbsp;=&nbsp;LV_PDF_FULLPATH.<br />
<br />
&nbsp;&nbsp;"2.DOWNLOAD_TEMPLATE<br />
&nbsp;&nbsp;"2-1)CALL&nbsp;FUNCTION&nbsp;'WS_FILE_DELETE'<br />
&nbsp;&nbsp;"##&nbsp;PC#&nbsp;##&nbsp;###&nbsp;###&nbsp;##&nbsp;###&nbsp;####&nbsp;##<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WS_FILE_DELETE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_PDF_FULLPATH<br />
   </div>
   <div class="code">
&nbsp;&nbsp;.<br />
<br />
&nbsp;&nbsp;"2-2)SELECT&nbsp;FROM&nbsp;WWWDATA.--SMW0&nbsp;####&nbsp;##&nbsp;(WWWDATA)<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;LS_KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;WWWDATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;'ZEDR12_EXCEL'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'##&nbsp;###(ZEDR12_EXCEL)#&nbsp;SMW0#&nbsp;####&nbsp;##&nbsp;####.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"2-3)CALL&nbsp;FUNCTION&nbsp;'DOWNLOAD_WEB_OBJECT'<br />
&nbsp;&nbsp;"SMW0(##)#&nbsp;##&nbsp;###&nbsp;###&nbsp;####&nbsp;##&nbsp;PC#&nbsp;######&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DOWNLOAD_WEB_OBJECT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESTINATION&nbsp;=&nbsp;LV_EXCEL_RLGRAP.<br />
<br />
&nbsp;&nbsp;"3.OPEN_EXCEL_TEMPLATE<br />
<br />
&nbsp;&nbsp;INCLUDE&nbsp;OLE2INCL.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;OLE_EXCEL&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OLE_BOOKS&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OLE_SHEETS&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OLE_SHEET&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LO_WORKBOOK&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CELL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;OLE2_OBJECT.<br />
<br />
&nbsp;&nbsp;"&nbsp;“##&nbsp;#######&nbsp;#####”&nbsp;##&nbsp;#<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;OLE_EXCEL&nbsp;'Excel.Application'.<br />
<br />
&nbsp;&nbsp;"OLE_EXCEL#&nbsp;OLE_BOOKS#&nbsp;###.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_EXCEL&nbsp;'Workbooks'&nbsp;=&nbsp;OLE_BOOKS.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;####&nbsp;####&nbsp;###&nbsp;##.&nbsp;##&nbsp;#####&nbsp;###.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_BOOKS&nbsp;'OPEN'&nbsp;=&nbsp;LO_WORKBOOK<br />
&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_EXCEL_FULLPATH.<br />
<br />
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;OLE_EXCEL&nbsp;'ACTIVESHEET'&nbsp;=&nbsp;OLE_SHEET.<br />
<br />
<br />
&nbsp;&nbsp;"4.&nbsp;FILL_EXCEL_LINE<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_ALV&nbsp;LIKE&nbsp;GS_ZTCURR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_ALV&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;GS_ZTCURR.<br />
&nbsp;&nbsp;DATA:&nbsp;LV_ROW&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;2.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;1.&nbsp;"#1&nbsp;ROW&nbsp;//&nbsp;#2&nbsp;COL<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'####'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'####'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'####'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'####'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'##'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'########'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'########'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'###'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;'###'.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_ZTCURR&nbsp;INTO&nbsp;LS_ALV.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;1##&nbsp;####.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-KURST.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;2##&nbsp;####.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-FCURR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;3##&nbsp;##&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-TCURR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;4##&nbsp;##&nbsp;###.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-GDATU.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;5##&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-UKURS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;6##&nbsp;######&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-FFACT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;7##&nbsp;######&nbsp;##.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-TFACT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;8##&nbsp;###.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-CRNAME.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"EXCEL&nbsp;9##&nbsp;###.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_SHEET&nbsp;'CELLS'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;LV_ROW&nbsp;#2&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'VALUE'&nbsp;=&nbsp;LS_ALV-CRDATE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_ROW&nbsp;=&nbsp;LV_ROW&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"PDF##<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;LO_WORKBOOK&nbsp;'ExportAsfixedFormat'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;0&nbsp;"####&nbsp;pdf<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;LV_PDF_FULLPATH.&nbsp;"####+###.<br />
<br />
<br />
&nbsp;&nbsp;"4-1.&nbsp;##&nbsp;###&nbsp;/&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;OLE_EXCEL&nbsp;'DisplayAlerts'&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;LO_WORKBOOK&nbsp;'Close'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;OLE_EXCEL&nbsp;'Quit'.<br />
<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;CELL.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;OLE_SHEET.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;OLE_BOOKS.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;LO_WORKBOOK.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;OLE_EXCEL.<br />
<br />
&nbsp;&nbsp;"5.&nbsp;DELETE&nbsp;&nbsp;FILE<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;FILE_DELETE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILENAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_EXCEL_FULLPATH<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_RC<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_DELETE_FAILED&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACCESS_DENIED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNKNOWN_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;=&nbsp;7<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRONG_PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;Implement&nbsp;suitable&nbsp;error&nbsp;handling&nbsp;here<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750</td>
   </tr>
</table>
</body>
</html>
