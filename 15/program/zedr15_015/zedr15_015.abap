
*&---------------------------------------------------------------------*

*& Report ZEDR15_015

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR15_015.






*"INTO ### (1)

*DATA :BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME INTO GS_SCARR

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*  WRITE : / GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDSELECT.



*"INTO ### (2)

*DATA :BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT SINGLE CARRID CARRNAME INTO (GS_SCARR-CARRID, GS_SCARR-CARRNAME)

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*WRITE : / GS_SCARR-CARRID, GS_SCARR-CARRNAME.



*"INTO ITAB(1)

*DATA :BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME INTO TABLE GT_SCARR

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE : / GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"INTO ITAB(2)- CORRESPONDING FIELDS OF




*DATA :BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  "INTO TABLE GT_SCARR " ## #### ####### ###

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR " WA# ## #### # ##

*  WHERE CARRID = 'AA'.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  "INTO CORRESPONDING FIELDS OF TABLE GT_SCARR "####### # ### APPEND# ## ## #####

*  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR "####### ### INSERT#

*  WHERE CARRID = 'AB'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE : / GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"WHERE




*DATA :BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  "WHERE CARRID BETWEEN 'AA' AND 'AB'. " BETWEEN A AND B

*  "WHERE CARRID LIKE 'A%'."STRING ##

*  WHERE CARRID IN ('AA','AB')."LIST VALUE

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE : / GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*"RANGE TABLE(1)

*RANGES : GR_SCARR FOR SCARR-CARRID.

*

*CLEAR : GR_SCARR.

*

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'CP'. "####

*GR_SCARR-LOW = '*A'.

*APPEND GR_SCARR.

*

*DATA : BEGIN OF GS_SCARR.

*  INCLUDE TYPE SCARR.

*DATA : END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT *

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*BREAK-POINT.



*"RANGE TABLE(2)

*RANGES : GR_SCARR FOR SCARR-CARRID.

*

*DATA :BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*CLEAR : GR_SCARR.

*

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'EQ'.

*GR_SCARR-LOW = 'AA'.

*APPEND GR_SCARR.

*

*GR_SCARR-LOW = 'AC'.

*APPEND GR_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE : / GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*"GROUPING

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID, "AIRLINE CODE

*  CONNID TYPE SFLIGHT-CONNID, "FLIGHT CONNECTION NUMBER

*  GV_SUM TYPE I, "AIRFARE

*  END OF GS_SFLIGHT.

* DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

* SELECT CARRID CONNID

*   AVG( PRICE ) AS GV_SUM "### ## ##

*   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*   FROM SFLIGHT GROUP BY CARRID CONNID.

*

* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*   WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

* ENDLOOP.



*"HAVING

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

* DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

* SELECT CARRID CONNID

*   AVG( PRICE ) AS GV_SUM "### ## ##

*   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*   FROM SFLIGHT GROUP BY CARRID CONNID

*   HAVING AVG( PRICE ) > 1000.

*

* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*   WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

* ENDLOOP.



* "ORDER BY

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

* DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

* SELECT CARRID CONNID

*   AVG( PRICE ) AS GV_SUM "### ## ##

*   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*   FROM SFLIGHT GROUP BY CARRID CONNID

*   HAVING AVG( PRICE ) > 1000

*   "ORDER BY CARRID DESCENDING.

*   ORDER BY GV_SUM.

*

* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*   WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

* ENDLOOP.



* "SUBQUERY

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  END OF GS_SFLIGHT.

* DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

* SELECT CARRID

*        CONNID

*        PRICE

*   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*   FROM SFLIGHT AS A "## ##

*   WHERE CARRID IN ( SELECT CARRID "CARRID# SUBQUERY ### ## #### ####

*                      FROM SPFLI

*                      WHERE CARRID = A~CARRID " ~# SQL#### ### ## ### ### #

*                        AND CONNID = A~CONNID ) "-# ABAP #### ###### ### ### # ##

*   AND CARRID = 'AA'

*   AND CONNID LIKE '00%'.

*

* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*   WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-PRICE.

* ENDLOOP.



*" JOIN - INNER JOIN

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  CARRNAME TYPE SCARR-CARRNAME,

*  END OF GS_SFLIGHT.

* DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

* SELECT A~CARRID "#### #### ## ##### ##

*        A~CONNID

*        B~CARRNAME

*   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*   FROM SFLIGHT AS A INNER JOIN SCARR AS B "## ##

*   ON A~CARRID = B~CARRID "WHERE### ON### #### ### WHERE## ## # ON#### JOIN

*   WHERE A~CARRID = 'AA'.

*

* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*   WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

* ENDLOOP.



*" JOIN - OUTER JOIN

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  CARRNAME TYPE SCARR-CARRNAME,

*  END OF GS_SFLIGHT.

* DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

* SELECT A~CARRID "#### #### ## ##### ##

*        A~CONNID

*        B~CARRNAME

*   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*   FROM SFLIGHT AS A LEFT OUTER JOIN SCARR AS B "## ##

*   ON A~CARRID = B~CARRID "WHERE### ON### #### ### WHERE## ## # ON#### JOIN

*   WHERE A~CARRID = 'AA'.

*

* LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*   WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

* ENDLOOP.






"FOR ALL ENTRIES

DATA : BEGIN OF GS_SPFLI,

  CARRID TYPE SPFLI-CARRID,

  CONNID TYPE SPFLI-CONNID,

  END OF GS_SPFLI.

DATA : GT_SPFLI LIKE TABLE OF GS_SPFLI.



DATA : BEGIN OF GS_SFLIGHT,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  FLDATE TYPE SFLIGHT-FLDATE,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT.

DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.



SELECT CARRID CONNID

  FROM SPFLI

  INTO CORRESPONDING FIELDS OF TABLE GT_SPFLI

  WHERE CARRID LIKE 'A%'.



SELECT CARRID CONNID FLDATE PRICE

  FROM SFLIGHT

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

  FOR ALL ENTRIES IN GT_SPFLI

  WHERE CARRID = GT_SPFLI-CARRID

  AND CONNID = GT_SPFLI-CONNID.



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE : / GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

ENDLOOP.