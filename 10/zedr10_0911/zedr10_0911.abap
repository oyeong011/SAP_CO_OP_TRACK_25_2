
*&---------------------------------------------------------------------*

*& Report ZEDR10_0911

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR10_0911.



TYPES: BEGIN OF T_STUDENT,

  include structure
ZEDT10_001
.

  TYPES: ZGNAME TYPE C LENGTH 20,

  END OF T_STUDENT.



DATA: GS_STUDENT TYPE T_STUDENT.

DATA: GT_ORI_STUDENT LIKE TABLE OF ZEDT10_001,

      GT_STUDENT LIKE TABLE OF GS_STUDENT

        WITH NON-UNIQUE KEY INCLUDE-ZCODE.            " KEY ## ##### MODIFY TABLE ####



" # ### ## #### # ## ####.

SELECT *

  FROM ZEDT10_001

  INTO TABLE @GT_ORI_STUDENT.



READ TABLE GT_ORI_STUDENT INTO GS_STUDENT INDEX 1.

APPEND GS_STUDENT TO GT_STUDENT.



READ TABLE GT_ORI_STUDENT INTO GS_STUDENT INDEX 2.

APPEND GS_STUDENT TO GT_STUDENT.

" ### APPEND ##




*GS_STUDENT-INCLUDE-ZGENDER = 'F'.

*APPEND GS_STUDENT TO GT_STUDENT.

*BREAK-POINT.




" MODIFY # ## ###

" INCLUDE ### KEY #### ### #### ### ##. WHERE## ######.

GS_STUDENT-INCLUDE-ZGENDER = 'F'.

" #### KEY ## #### ##

MODIFY TABLE GT_STUDENT FROM GS_STUDENT.

" KEY ## ###### ### ## ##

" TRANSPORTING INCLUDE-ZGENDER WHERE INCLUDE-ZCODE = GS_STUDENT-INCLUDE-ZCODE.



READ TABLE GT_ORI_STUDENT INTO GS_STUDENT INDEX 3.

APPEND GS_STUDENT TO GT_STUDENT.

GS_STUDENT-INCLUDE-ZGENDER = 'N'.

MODIFY GT_STUDENT FROM GS_STUDENT TRANSPORTING INCLUDE-ZGENDER

WHERE INCLUDE-ZCODE = GS_STUDENT-INCLUDE-ZCODE.



 " ## ##



CLEAR GS_STUDENT.

LOOP AT GT_STUDENT INTO GS_STUDENT.

  IF GS_STUDENT-INCLUDE-ZGENDER = 'M'.

    GS_STUDENT-ZGNAME = '##'.

    WRITE:/ '##'.

  ELSEIF GS_STUDENT-INCLUDE-ZGENDER = 'F'.

    GS_STUDENT-ZGNAME = '##'.

    WRITE:/ '##'.

  ELSE.

    GS_STUDENT-ZGNAME = '##'.

    WRITE:/ '##'.

  ENDIF.

  MODIFY GT_STUDENT FROM GS_STUDENT.






*  CLEAR GS_STUDENT.

*  BREAK-POINT.




ENDLOOP.










*BREAK-POINT.






ULINE /.

" INTERNAL TALBE DELETE



" # ### ## #### # ## ####.

MOVE GT_ORI_STUDENT[] TO GT_STUDENT[].



" ## ###

LOOP AT GT_STUDENT INTO GS_STUDENT.

  IF GS_STUDENT-INCLUDE-ZGENDER <> 'F'.

    DELETE TABLE GT_STUDENT FROM GS_STUDENT.

    IF SY-SUBRC = 0.

    ELSE.

      WRITE:/ '## ##'.

    ENDIF.



    ELSE.

      WRITE:/ GS_STUDENT-INCLUDE-ZCODE, GS_STUDENT-INCLUDE-ZKNAME, GS_STUDENT-INCLUDE-ZGENDER.

  ENDIF.

ENDLOOP.



" # ### ## #### # ## ####.

MOVE GT_ORI_STUDENT[] TO GT_STUDENT[].



" WHERE #### # ## ##

" ### ## ##

DELETE GT_STUDENT WHERE INCLUDE-ZGENDER ='F'.



IF SY-SUBRC = 0.

  LOOP AT GT_STUDENT INTO GS_STUDENT.

    WRITE:/ GS_STUDENT-INCLUDE-ZCODE, GS_STUDENT-INCLUDE-ZKNAME, GS_STUDENT-INCLUDE-ZGENDER.

  ENDLOOP.

ENDIF.





ULINE /.

" # ### ## #### # ## ####.

MOVE GT_ORI_STUDENT[] TO GT_STUDENT[].



" ### ### # ##.

READ TABLE GT_STUDENT INTO GS_STUDENT INDEX 10.

APPEND GS_STUDENT TO GT_STUDENT.



READ TABLE GT_STUDENT INTO GS_STUDENT INDEX 5.

GS_STUDENT-INCLUDE-ZTEL = '01099998888'.

APPEND GS_STUDENT TO GT_STUDENT.



SORT GT_STUDENT.






*LOOP AT GT_STUDENT INTO GS_STUDENT.

*  WRITE:/ GS_STUDENT-INCLUDE-ZCODE, GS_STUDENT-INCLUDE-ZKNAME.

*ENDLOOP.

*ULINE.






" ### ### ## ## '10'## ###

DELETE ADJACENT DUPLICATES FROM GT_STUDENT.






*LOOP AT GT_STUDENT INTO GS_STUDENT.

*  WRITE:/ GS_STUDENT-INCLUDE-ZCODE, GS_STUDENT-INCLUDE-ZKNAME.

*ENDLOOP.

*ULINE.






" ### ### #### '5'## ###

DELETE ADJACENT DUPLICATES FROM GT_STUDENT COMPARING INCLUDE-ZCODE.






*LOOP AT GT_STUDENT INTO GS_STUDENT.

*  WRITE:/ GS_STUDENT-INCLUDE-ZCODE, GS_STUDENT-INCLUDE-ZKNAME.

*ENDLOOP.

*ULINE.






BREAK-POINT.