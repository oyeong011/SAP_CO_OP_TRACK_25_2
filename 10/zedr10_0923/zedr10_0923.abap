
*&---------------------------------------------------------------------*

*& Report ZEDR10_0923

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR10_0923.



DATA: BEGIN OF GS_SCARR.

  DATA: ZCHECK TYPE C.

  INCLUDE TYPE SCARR.




*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,




DATA: END OF GS_SCARR.

DATA: GT_SCARR LIKE TABLE OF GS_SCARR.



SELECT SINGLE A~CARRID A~CARRNAME INTO ( GS_SCARR-CARRID, GS_SCARR-CARRNAME )

  FROM SCARR as A

  WHERE CARRID = 'AA'.



WRITE:/ GS_SCARR.



" #### ## INTO ## X

" INTERNAL TABLE# #### ##




*select carrid carrname into table gt_scarr

*  from scarr

*  where carrid = 'a%'.








" ### ### FIELD # ## ### #### ### #.

SELECT CARRID CARRNAME

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

  FROM SCARR

  .





" INTO ## APPENDING# #### OVERWRITTEN ### ### # ##

SELECT CARRID CARRNAME

  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR

  FROM SCARR

  WHERE CARRID BETWEEN 'AA' AND 'AB'.



SELECT CARRID CARRNAME

  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR

  FROM SCARR

  WHERE CARRID IN ( 'AC' , 'AF' ).





LOOP AT GT_SCARR INTO GS_SCARR.

  WRITE:/ GS_SCARR.

ENDLOOP.



ULINE /.



RANGES GR_SCARR FOR SCARR-CARRID.



GR_SCARR-SIGN = 'I'.

GR_SCARR-OPTION = 'CP'.

GR_SCARR-LOW = '*A'.

APPEND GR_SCARR.



GR_SCARR-SIGN = 'I'.

GR_SCARR-OPTION = 'EQ'.

GR_SCARR-HIGH = 'ZZ'.

APPEND GR_SCARR.



SELECT * FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

  WHERE CARRID IN GR_SCARR.






*BREAK-POINT.








DATA: BEGIN OF GS_SFLIGHT.

  INCLUDE TYPE SFLIGHT.

  INCLUDE TYPE SCARR AS CARR RENAMING WITH SUFFIX _CARR.

DATA: END OF GS_SFLIGHT.



DATA: GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.



SELECT CARRID

  CONNID

  PRICE

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

  FROM SFLIGHT AS A

  WHERE CARRID

    IN ( SELECT CARRID

                FROM SPFLI

                WHERE CARRID = A~CARRID

                      AND CONNID = A~CONNID )

  AND CARRID = 'AA'

  AND CONNID LIKE '00%'.






*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE:/ GS_SFLIGHT-CARRID.

*ENDLOOP.






SELECT A~CARRID

  A~CONNID

  B~CARRNAME

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

  FROM SFLIGHT AS A

  INNER JOIN SCARR AS B

  ON A~CARRID = B~CARRID

  WHERE A~CARRID = 'AA'.



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE:/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME_CARR.

ENDLOOP.



DATA: GS_SPFLI TYPE SPFLI,

      GT_SPFLI LIKE TABLE OF GS_SPFLI.



SELECT

  CARRID

  CONNID

  FLDATE

  PRICE

  FROM SFLIGHT

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

  FOR ALL ENTRIES IN GT_SPFLI

  WHERE CARRID <> GT_SPFLI-CARRID

  AND CONNID <> GT_SPFLI-CONNID

  .



BREAK-POINT.



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE:/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

ENDLOOP.