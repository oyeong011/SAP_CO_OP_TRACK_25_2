
*&---------------------------------------------------------------------*

*& Report ZEDR19_033

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR19_033.






*SELECT CARRID CARRNAME INTO GS_SCARR

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDSELECT.



*SELECT SINGLE CARRID CARRNAME INTO ( GS_SCARR-CARRID, GS_SCARR-CARRNAME )

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.



*SELECT CARRID "Airline Code

*       CARRNAME "Airline name

*  FROM SCARR

*  INTO TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*SELECT CARRID "Airline Code

*       CARRNAME "Airline name

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR "## ### ### #### ##

*  WHERE CARRID = 'AA'.

*

*SELECT CARRID "Airline Code

*       CARRNAME "Airline name

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR "##### #### GT #### ##

*  WHERE CARRID = 'AB'.



*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.



*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID BETWEEN 'A' AND 'AB'. "CARRID# 'A' ## 'AB' ### ## GT_SCARR# ##



*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID LIKE 'A%'. "CARRID# A# #### ## ##

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN ( 'AA', 'AC' ). "## ### ##

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*RANGES ## ## # ## ##

*DATA : BEGIN OF GR_SCARR OCCURS 0,

*  SIGN TYPE DDSIGN, "### ## #### #### #### ###

*  OPTION TYPE DDOPTION, "### ## ## ### ##

*  LOW LIKE SCARR-CARRID,

*  HIGH LIKE SCARR-CARRID,

*  END OF GR_SCARR.



*CLEAR : GR_SCARR.

*SCARR-OPTION = 'CP'.

*GR_SCARR-LOW = '*A'.

*APPEND GR_SCARR.

*

*DATA : BEGIN OF GS_SCARR.

*  INCLUDE TYPE SCARR.

*DATA : END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT * FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.



*RANGES GR_SCARR FOR SCARR-CARRID.

*

*DATA : BEGIN OF GS_SCARR.

*  INCLUDE TYPE SCARR.

*DATA : END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*GR_SCARR-SIGN = 'I'. "SIGN = 'I' ####

*GR_SCARR-OPTION = 'EQ'. "=

*GR_SCARR-LOW = 'AA'. "CARRID = 'AA' ## ##

*APPEND GR_SCARR.

*

*GR_SCARR-LOW = 'AC'. "CARRID = 'AC' ## ##

*APPEND GR_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM "SQL## INTO CORRESPONDING FIELDS OF TABLE ### #### #### ### AS ## ## !!!!

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  "GROUP BY# ### ##### # ## ### ## ###? -> having

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY CARRID.

*  "SELECT ### ### #### ## # ##

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY CONNID DESCENDING. "CONNID# ###### ##

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY PRICE. "PRICE ### #### #### ##

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY GV_SUM. "## ### #### OK

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT

*  WHERE CARRID IN ( SELECT CARRID

*                     FROM SPFLI

*                    WHERE CARRID = SFLIGHT-CARRID

*                      AND CONNID = SFLIGHT-CONNID )

*"##### ### ## #### ####

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A "## ##

*  WHERE CARRID IN ( SELECT CARRID

*                     FROM SPFLI

*                    WHERE CARRID = A-CARRID

*                      AND CONNID = A-CONNID ) "## ##

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.



*SELECT A~CARRID

*       A~CONNID

*       B~CARRNAME "## ##

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A "## ##

*  INNER JOIN SCARR AS B "## ##

*  ON A~CARRID = B~CARRID "inner join ##

*  WHERE A~CARRID = 'AA'. "## ## ###

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

*ENDLOOP.



*SELECT A~CARRID

*       A~CONNID

*       B~CARRNAME

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  LEFT OUTER JOIN SCARR AS B "JOIN ### ### ## #### #### SELECT ### ##

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

*ENDLOOP.



*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  CARRNAME TYPE SCARR-CARRNAME,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT A~CARRID

*       A~CONNID

*       B~CARRNAME

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  LEFT OUTER JOIN SCARR AS B

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

*ENDLOOP.






DATA : BEGIN OF GS_SPFLI,

  CARRID TYPE SPFLI-CARRID,

  CONNID TYPE SPFLI-CONNID,

  END OF GS_SPFLI.

DATA : GT_SPFLI LIKE TABLE OF GS_SPFLI.



DATA : BEGIN OF GS_SFLIGHT,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  FLDATE TYPE SFLIGHT-FLDATE,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT.

DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.






*SELECT CARRID

*       CONNID

*  FROM SFLIGHT

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FOR ALL ENTRIES IN GT_SPFLI

*  WHERE CARRID = GT_SPFLI-CARRID

*  AND CONNID = GT_SPFLI-CONNID.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

*ENDLOOP.






SELECT CARRID

       CONNID

  FROM SFLIGHT

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT "### ## ### GT_SPFLI# ##### ##

  WHERE CARRID LIKE 'A%'.



IF GT_SPFLI IS NOT INITIAL.

  SELECT CARRID

         CONNID

         FLDATE

         PRICE

    FROM SFLIGHT

    INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

    FOR ALL ENTRIES IN GT_SPFLI "## GT_SPFLI# #####? where ### #### ## GT_SPFLI# ###

    WHERE CARRID = GT_SPFLI-CARRID

    AND CONNID = GT_SPFLI-CONNID.

ENDIF.



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

ENDLOOP.