<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZEDR08_013</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEDR08_013</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Report&nbsp;ZEDR08_013<br />
*&---------------------------------------------------------------------*<br />
*&<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
REPORT ZEDR08_013.<br />
<br />
DATA : BEGIN OF GS_SCARR,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR.<br />
<br />
DATA : GT_SCARR LIKE TABLE OF GS_SCARR.<br />
<br />
SELECT CARRID CARRNAME INTO GS_SCARR<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SCARR-CARRID,&nbsp;GS_SCARR-CARRNAME.<br />
ENDSELECT.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR01,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR01.<br />
<br />
DATA : GT_SCARR01 LIKE TABLE OF GS_SCARR01.<br />
<br />
SELECT SINGLE CARRID CARRNAME INTO ( GS_SCARR-CARRID, GS_SCARR-CARRNAME )<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
WRITE :/ GS_SCARR01-CARRID, GS_SCARR01-CARRNAME.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR02,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR02.<br />
<br />
DATA : GT_SCARR02 LIKE TABLE OF GS_SCARR02.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;GT_SCARR02<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
LOOP AT GT_SCARR02 INTO GS_SCARR02.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SCARR02-CARRID,&nbsp;GS_SCARR02-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR03,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR03.<br />
<br />
DATA : GT_SCARR03 LIKE TABLE OF GS_SCARR03.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR03<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
LOOP AT GT_SCARR03 INTO GS_SCARR03.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SCARR03-CARRID,&nbsp;GS_SCARR03-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR04,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR04.<br />
<br />
DATA : GT_SCARR04 LIKE TABLE OF GS_SCARR04.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR04<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR04<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AB'.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR05,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR05.<br />
<br />
DATA : GT_SCARR05 LIKE TABLE OF GS_SCARR05.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR05<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;APPENDING&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR05<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;'AB'.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR06,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR06.<br />
<br />
DATA : GT_SCARR06 LIKE TABLE OF GS_SCARR06.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR06<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;BETWEEN&nbsp;'AA'&nbsp;AND&nbsp;'AB'.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR07,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR07.<br />
<br />
DATA : GT_SCARR07 LIKE TABLE OF GS_SCARR07.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR07<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;LIKE&nbsp;'A%'.<br />
<br />
LOOP AT GT_SCARR07 INTO GS_SCARR07.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SCARR07-CARRID,&nbsp;GS_SCARR07-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SCARR08,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR08.<br />
<br />
DATA : GT_SCARR08 LIKE TABLE OF GS_SCARR08.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR08<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;IN&nbsp;(&nbsp;'AA',&nbsp;'AC'&nbsp;).<br />
<br />
LOOP AT GT_SCARR08 INTO GS_SCARR08.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SCARR08-CARRID,&nbsp;GS_SCARR08-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
RANGES : GR_SCARR FOR SCARR-CARRID.<br />
<br />
CLEAR : GR_SCARR.<br />
<br />
GR_SCARR-SIGN = 'I'.<br />
GR_SCARR-OPTION = 'CP'.<br />
GR_SCARR-LOW = '*A'.<br />
APPEND GR_SCARR.<br />
<br />
DATA : BEGIN OF GS_SCARR09.<br />
&nbsp;&nbsp;INCLUDE&nbsp;TYPE&nbsp;SCARR.<br />
DATA : END OF GS_SCARR09.<br />
<br />
DATA : GT_SCARR09 LIKE TABLE OF GS_SCARR09.<br />
<br />
SELECT * FROM SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR09<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;IN&nbsp;GR_SCARR.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
RANGES GR_SCARR01 FOR SCARR-CARRID.<br />
<br />
DATA : BEGIN OF GS_SCARR10,<br />
&nbsp;&nbsp;ZCHECK&nbsp;TYPE&nbsp;C,<br />
&nbsp;&nbsp;CARRID&nbsp;LIKE&nbsp;SCARR-CARRID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;LIKE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SCARR10.<br />
<br />
DATA : GT_SCARR10 LIKE TABLE OF GS_SCARR10.<br />
<br />
GR_SCARR01-SIGN = 'I'.<br />
GR_SCARR01-OPTION = 'EQ'.<br />
GR_SCARR01-LOW = 'AA'.<br />
<br />
GR_SCARR01-LOW = 'AC'.<br />
APPEND GR_SCARR01.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CARRNAME<br />
&nbsp;&nbsp;FROM&nbsp;SCARR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SCARR10<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;IN&nbsp;GR_SCARR01.<br />
<br />
LOOP AT GT_SCARR10 INTO GS_SCARR10.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SCARR10-CARRID,&nbsp;GS_SCARR10-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;GV_SUM&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT.<br />
<br />
DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;AS&nbsp;GV_SUM<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;GROUP&nbsp;BY&nbsp;CARRID&nbsp;CONNID.<br />
<br />
LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT-CARRID,&nbsp;GS_SFLIGHT-CONNID,&nbsp;GS_SFLIGHT-GV_SUM.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT01,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;GV_SUM&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT01.<br />
<br />
DATA : GT_SFLIGHT01 LIKE TABLE OF GS_SFLIGHT01.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;AS&nbsp;GV_SUM<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT01<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;GROUP&nbsp;BY&nbsp;CARRID&nbsp;CONNID<br />
&nbsp;&nbsp;HAVING&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;&gt;&nbsp;1000.<br />
<br />
LOOP AT GT_SFLIGHT01 INTO GS_SFLIGHT01.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT01-CARRID,&nbsp;GS_SFLIGHT01-CONNID,&nbsp;GS_SFLIGHT01-GV_SUM.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT02,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;GV_SUM&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT02.<br />
<br />
DATA : GT_SFLIGHT02 LIKE TABLE OF GS_SFLIGHT02.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;AS&nbsp;GV_SUM<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT02<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;GROUP&nbsp;BY&nbsp;CARRID&nbsp;CONNID<br />
&nbsp;&nbsp;HAVING&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;&gt;&nbsp;1000<br />
&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;CARRID.<br />
<br />
LOOP AT GT_SFLIGHT02 INTO GS_SFLIGHT02.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT02-CARRID,&nbsp;GS_SFLIGHT02-CONNID,&nbsp;GS_SFLIGHT02-GV_SUM.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT03,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;GV_SUM&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT03.<br />
<br />
DATA : GT_SFLIGHT03 LIKE TABLE OF GS_SFLIGHT03.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;AS&nbsp;GV_SUM<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT03<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;GROUP&nbsp;BY&nbsp;CARRID&nbsp;CONNID<br />
&nbsp;&nbsp;HAVING&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;&gt;&nbsp;1000<br />
&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;CONNID&nbsp;DESCENDING.<br />
<br />
LOOP AT GT_SFLIGHT03 INTO GS_SFLIGHT03.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT03-CARRID,&nbsp;GS_SFLIGHT03-CONNID,&nbsp;GS_SFLIGHT03-GV_SUM.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT04,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;GV_SUM&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT04.<br />
<br />
DATA : GT_SFLIGHT04 LIKE TABLE OF GS_SFLIGHT04.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;AS&nbsp;GV_SUM<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT04<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;GROUP&nbsp;BY&nbsp;CARRID&nbsp;CONNID<br />
&nbsp;&nbsp;HAVING&nbsp;AVG(&nbsp;PRICE&nbsp;)&nbsp;&gt;&nbsp;1000<br />
&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;GV_SUM.<br />
<br />
LOOP AT GT_SFLIGHT04 INTO GS_SFLIGHT04.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT04-CARRID,&nbsp;GS_SFLIGHT04-CONNID,&nbsp;GS_SFLIGHT04-GV_SUM.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT05,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;PRICE&nbsp;TYPE&nbsp;SFLIGHT-PRICE,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT05.<br />
<br />
DATA : GT_SFLIGHT05 LIKE TABLE OF GS_SFLIGHT05.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRICE<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT05<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;IN&nbsp;(&nbsp;SELECT&nbsp;CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;SPFLI<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;SFLIGHT~CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CONNID&nbsp;=&nbsp;SFLIGHT~CONNID&nbsp;)<br />
&nbsp;&nbsp;AND&nbsp;CARRID&nbsp;=&nbsp;'AA'<br />
&nbsp;&nbsp;AND&nbsp;CONNID&nbsp;LIKE&nbsp;'00%'.<br />
<br />
LOOP AT GT_SFLIGHT05 INTO GS_SFLIGHT05.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT05-CARRID,&nbsp;GS_SFLIGHT05-CONNID,&nbsp;GS_SFLIGHT05-PRICE.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT06,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;PRICE&nbsp;TYPE&nbsp;SFLIGHT-PRICE,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT06.<br />
<br />
DATA : GT_SFLIGHT06 LIKE TABLE OF GS_SFLIGHT06.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRICE<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT06<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;IN&nbsp;(&nbsp;SELECT&nbsp;CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;SPFLI<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;A~CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CONNID&nbsp;=&nbsp;A~CONNID&nbsp;)<br />
&nbsp;&nbsp;AND&nbsp;CARRID&nbsp;=&nbsp;'AA'<br />
&nbsp;&nbsp;AND&nbsp;CONNID&nbsp;LIKE&nbsp;'00%'.<br />
<br />
LOOP AT GT_SFLIGHT06 INTO GS_SFLIGHT06.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT06-CARRID,&nbsp;GS_SFLIGHT06-CONNID,&nbsp;GS_SFLIGHT06-PRICE.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT07,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT07-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT07-CONNID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;TYPE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT07.<br />
<br />
DATA : GT_SFLIGHT07 LIKE TABLE OF GS_SFLIGHT07.<br />
<br />
SELECT A~CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~CARRNAME<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT07<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;SCARR&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;ON&nbsp;A~CARRID&nbsp;=&nbsp;B~CARRID<br />
&nbsp;&nbsp;WHERE&nbsp;A~CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
LOOP AT GT_SFLIGHT07 INTO GS_SFLIGHT07.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT07-CARRID,&nbsp;GS_SFLIGHT07-CONNID,&nbsp;GS_SFLIGHT07-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT08,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;TYPE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT08.<br />
<br />
DATA : GT_SFLIGHT08 LIKE TABLE OF GS_SFLIGHT08.<br />
<br />
SELECT A~CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~CARRNAME<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT08<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;SCARR&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;ON&nbsp;A~CARRID&nbsp;=&nbsp;B~CARRID<br />
&nbsp;&nbsp;WHERE&nbsp;A~CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
LOOP AT GT_SFLIGHT08 INTO GS_SFLIGHT08.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT08-CARRID,&nbsp;GS_SFLIGHT08-CONNID,&nbsp;GS_SFLIGHT08-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SFLIGHT09,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;CARRNAME&nbsp;TYPE&nbsp;SCARR-CARRNAME,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT09.<br />
<br />
DATA : GT_SFLIGHT09 LIKE TABLE OF GS_SFLIGHT09.<br />
<br />
SELECT A~CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~CARRNAME<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT09<br />
&nbsp;&nbsp;FROM&nbsp;SFLIGHT&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;SCARR&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;ON&nbsp;A~CARRID&nbsp;=&nbsp;B~CARRID<br />
&nbsp;&nbsp;WHERE&nbsp;A~CARRID&nbsp;=&nbsp;'AA'.<br />
<br />
LOOP AT GT_SFLIGHT09 INTO GS_SFLIGHT09.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT09-CARRID,&nbsp;GS_SFLIGHT09-CONNID,&nbsp;GS_SFLIGHT09-CARRNAME.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
<br />
DATA : BEGIN OF GS_SPFLI,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SPFLI-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SPFLI-CONNID,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SPFLI.<br />
<br />
DATA : GT_SPFLI LIKE TABLE OF GS_SPFLI.<br />
<br />
DATA : BEGIN OF GS_SFLIGHT10,<br />
&nbsp;&nbsp;CARRID&nbsp;TYPE&nbsp;SFLIGHT-CARRID,<br />
&nbsp;&nbsp;CONNID&nbsp;TYPE&nbsp;SFLIGHT-CONNID,<br />
&nbsp;&nbsp;FLDATE&nbsp;TYPE&nbsp;SFLIGHT-FLDATE,<br />
&nbsp;&nbsp;PRICE&nbsp;TYPE&nbsp;SFLIGHT-PRICE,<br />
&nbsp;&nbsp;END&nbsp;OF&nbsp;GS_SFLIGHT10.<br />
<br />
DATA : GT_SFLIGHT10 LIKE TABLE OF GS_SFLIGHT10.<br />
<br />
SELECT CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;FROM&nbsp;SPFLI<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SPFLI<br />
&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;LIKE&nbsp;'A%'.<br />
<br />
IF GT_SPFLI IS NOT INITIAL.<br />
&nbsp;&nbsp;SELECT&nbsp;CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONNID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FLDATE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PRICE<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;SFLIGHT<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_SFLIGHT10<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;GT_SPFLI<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CARRID&nbsp;=&nbsp;GT_SPFLI-CARRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CONNID&nbsp;=&nbsp;GT_SPFLI-CONNID.<br />
ENDIF.<br />
<br />
LOOP AT GT_SFLIGHT10 INTO GS_SFLIGHT10.<br />
&nbsp;&nbsp;WRITE&nbsp;:/&nbsp;GS_SFLIGHT10-CARRID,&nbsp;GS_SFLIGHT10-CONNID,&nbsp;GS_SFLIGHT10-FLDATE,&nbsp;GS_SFLIGHT10-PRICE.<br />
ENDLOOP.<br />
<br />
"-----------------------------------------------------------------------<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750</td>
   </tr>
</table>
</body>
</html>
