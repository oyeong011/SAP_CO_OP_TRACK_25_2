
*&---------------------------------------------------------------------*

*& Report ZEDR08_013

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR08_013.



DATA : BEGIN OF GS_SCARR,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR.



DATA : GT_SCARR LIKE TABLE OF GS_SCARR.



SELECT CARRID CARRNAME INTO GS_SCARR

  FROM SCARR

  WHERE CARRID = 'AA'.



  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

ENDSELECT.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR01,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR01.



DATA : GT_SCARR01 LIKE TABLE OF GS_SCARR01.



SELECT SINGLE CARRID CARRNAME INTO ( GS_SCARR-CARRID, GS_SCARR-CARRNAME )

  FROM SCARR

  WHERE CARRID = 'AA'.



WRITE :/ GS_SCARR01-CARRID, GS_SCARR01-CARRNAME.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR02,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR02.



DATA : GT_SCARR02 LIKE TABLE OF GS_SCARR02.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO TABLE GT_SCARR02

  WHERE CARRID = 'AA'.



LOOP AT GT_SCARR02 INTO GS_SCARR02.

  WRITE :/ GS_SCARR02-CARRID, GS_SCARR02-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR03,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR03.



DATA : GT_SCARR03 LIKE TABLE OF GS_SCARR03.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR03

  WHERE CARRID = 'AA'.



LOOP AT GT_SCARR03 INTO GS_SCARR03.

  WRITE :/ GS_SCARR03-CARRID, GS_SCARR03-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR04,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR04.



DATA : GT_SCARR04 LIKE TABLE OF GS_SCARR04.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR04

  WHERE CARRID = 'AA'.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR04

  WHERE CARRID = 'AB'.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR05,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR05.



DATA : GT_SCARR05 LIKE TABLE OF GS_SCARR05.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR05

  WHERE CARRID = 'AA'.



SELECT CARRID

       CARRNAME

  FROM SCARR

  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR05

  WHERE CARRID = 'AB'.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR06,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR06.



DATA : GT_SCARR06 LIKE TABLE OF GS_SCARR06.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR06

  WHERE CARRID BETWEEN 'AA' AND 'AB'.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR07,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR07.



DATA : GT_SCARR07 LIKE TABLE OF GS_SCARR07.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR07

  WHERE CARRID LIKE 'A%'.



LOOP AT GT_SCARR07 INTO GS_SCARR07.

  WRITE :/ GS_SCARR07-CARRID, GS_SCARR07-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SCARR08,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR08.



DATA : GT_SCARR08 LIKE TABLE OF GS_SCARR08.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR08

  WHERE CARRID IN ( 'AA', 'AC' ).



LOOP AT GT_SCARR08 INTO GS_SCARR08.

  WRITE :/ GS_SCARR08-CARRID, GS_SCARR08-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



RANGES : GR_SCARR FOR SCARR-CARRID.



CLEAR : GR_SCARR.



GR_SCARR-SIGN = 'I'.

GR_SCARR-OPTION = 'CP'.

GR_SCARR-LOW = '*A'.

APPEND GR_SCARR.



DATA : BEGIN OF GS_SCARR09.

  INCLUDE TYPE SCARR.

DATA : END OF GS_SCARR09.



DATA : GT_SCARR09 LIKE TABLE OF GS_SCARR09.



SELECT * FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR09

  WHERE CARRID IN GR_SCARR.



"-----------------------------------------------------------------------



RANGES GR_SCARR01 FOR SCARR-CARRID.



DATA : BEGIN OF GS_SCARR10,

  ZCHECK TYPE C,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR10.



DATA : GT_SCARR10 LIKE TABLE OF GS_SCARR10.



GR_SCARR01-SIGN = 'I'.

GR_SCARR01-OPTION = 'EQ'.

GR_SCARR01-LOW = 'AA'.



GR_SCARR01-LOW = 'AC'.

APPEND GR_SCARR01.



SELECT CARRID

       CARRNAME

  FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR10

  WHERE CARRID IN GR_SCARR01.



LOOP AT GT_SCARR10 INTO GS_SCARR10.

  WRITE :/ GS_SCARR10-CARRID, GS_SCARR10-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE I,

  END OF GS_SFLIGHT.



DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.



SELECT CARRID

       CONNID

       AVG( PRICE ) AS GV_SUM

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

  FROM SFLIGHT GROUP BY CARRID CONNID.



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT01,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE I,

  END OF GS_SFLIGHT01.



DATA : GT_SFLIGHT01 LIKE TABLE OF GS_SFLIGHT01.



SELECT CARRID

       CONNID

       AVG( PRICE ) AS GV_SUM

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT01

  FROM SFLIGHT GROUP BY CARRID CONNID

  HAVING AVG( PRICE ) > 1000.



LOOP AT GT_SFLIGHT01 INTO GS_SFLIGHT01.

  WRITE :/ GS_SFLIGHT01-CARRID, GS_SFLIGHT01-CONNID, GS_SFLIGHT01-GV_SUM.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT02,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE I,

  END OF GS_SFLIGHT02.



DATA : GT_SFLIGHT02 LIKE TABLE OF GS_SFLIGHT02.



SELECT CARRID

       CONNID

       AVG( PRICE ) AS GV_SUM

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT02

  FROM SFLIGHT GROUP BY CARRID CONNID

  HAVING AVG( PRICE ) > 1000

  ORDER BY CARRID.



LOOP AT GT_SFLIGHT02 INTO GS_SFLIGHT02.

  WRITE :/ GS_SFLIGHT02-CARRID, GS_SFLIGHT02-CONNID, GS_SFLIGHT02-GV_SUM.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT03,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE I,

  END OF GS_SFLIGHT03.



DATA : GT_SFLIGHT03 LIKE TABLE OF GS_SFLIGHT03.



SELECT CARRID

       CONNID

       AVG( PRICE ) AS GV_SUM

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT03

  FROM SFLIGHT GROUP BY CARRID CONNID

  HAVING AVG( PRICE ) > 1000

  ORDER BY CONNID DESCENDING.



LOOP AT GT_SFLIGHT03 INTO GS_SFLIGHT03.

  WRITE :/ GS_SFLIGHT03-CARRID, GS_SFLIGHT03-CONNID, GS_SFLIGHT03-GV_SUM.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT04,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE I,

  END OF GS_SFLIGHT04.



DATA : GT_SFLIGHT04 LIKE TABLE OF GS_SFLIGHT04.



SELECT CARRID

       CONNID

       AVG( PRICE ) AS GV_SUM

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT04

  FROM SFLIGHT GROUP BY CARRID CONNID

  HAVING AVG( PRICE ) > 1000

  ORDER BY GV_SUM.



LOOP AT GT_SFLIGHT04 INTO GS_SFLIGHT04.

  WRITE :/ GS_SFLIGHT04-CARRID, GS_SFLIGHT04-CONNID, GS_SFLIGHT04-GV_SUM.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT05,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT05.



DATA : GT_SFLIGHT05 LIKE TABLE OF GS_SFLIGHT05.



SELECT CARRID

       CONNID

       PRICE

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT05

  FROM SFLIGHT

  WHERE CARRID IN ( SELECT CARRID

                      FROM SPFLI

                      WHERE CARRID = SFLIGHT~CARRID

                        AND CONNID = SFLIGHT~CONNID )

  AND CARRID = 'AA'

  AND CONNID LIKE '00%'.



LOOP AT GT_SFLIGHT05 INTO GS_SFLIGHT05.

  WRITE :/ GS_SFLIGHT05-CARRID, GS_SFLIGHT05-CONNID, GS_SFLIGHT05-PRICE.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT06,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT06.



DATA : GT_SFLIGHT06 LIKE TABLE OF GS_SFLIGHT06.



SELECT CARRID

       CONNID

       PRICE

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT06

  FROM SFLIGHT AS A

  WHERE CARRID IN ( SELECT CARRID

                      FROM SPFLI

                      WHERE CARRID = A~CARRID

                        AND CONNID = A~CONNID )

  AND CARRID = 'AA'

  AND CONNID LIKE '00%'.



LOOP AT GT_SFLIGHT06 INTO GS_SFLIGHT06.

  WRITE :/ GS_SFLIGHT06-CARRID, GS_SFLIGHT06-CONNID, GS_SFLIGHT06-PRICE.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT07,

  CARRID TYPE SFLIGHT07-CARRID,

  CONNID TYPE SFLIGHT07-CONNID,

  CARRNAME TYPE SCARR-CARRNAME,

  END OF GS_SFLIGHT07.



DATA : GT_SFLIGHT07 LIKE TABLE OF GS_SFLIGHT07.



SELECT A~CARRID

       A~CONNID

       B~CARRNAME

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT07

  FROM SFLIGHT AS A

  INNER JOIN SCARR AS B

  ON A~CARRID = B~CARRID

  WHERE A~CARRID = 'AA'.



LOOP AT GT_SFLIGHT07 INTO GS_SFLIGHT07.

  WRITE :/ GS_SFLIGHT07-CARRID, GS_SFLIGHT07-CONNID, GS_SFLIGHT07-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT08,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  CARRNAME TYPE SCARR-CARRNAME,

  END OF GS_SFLIGHT08.



DATA : GT_SFLIGHT08 LIKE TABLE OF GS_SFLIGHT08.



SELECT A~CARRID

       A~CONNID

       B~CARRNAME

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT08

  FROM SFLIGHT AS A

  LEFT OUTER JOIN SCARR AS B

  ON A~CARRID = B~CARRID

  WHERE A~CARRID = 'AA'.



LOOP AT GT_SFLIGHT08 INTO GS_SFLIGHT08.

  WRITE :/ GS_SFLIGHT08-CARRID, GS_SFLIGHT08-CONNID, GS_SFLIGHT08-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SFLIGHT09,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  CARRNAME TYPE SCARR-CARRNAME,

  END OF GS_SFLIGHT09.



DATA : GT_SFLIGHT09 LIKE TABLE OF GS_SFLIGHT09.



SELECT A~CARRID

       A~CONNID

       B~CARRNAME

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT09

  FROM SFLIGHT AS A

  LEFT OUTER JOIN SCARR AS B

  ON A~CARRID = B~CARRID

  WHERE A~CARRID = 'AA'.



LOOP AT GT_SFLIGHT09 INTO GS_SFLIGHT09.

  WRITE :/ GS_SFLIGHT09-CARRID, GS_SFLIGHT09-CONNID, GS_SFLIGHT09-CARRNAME.

ENDLOOP.



"-----------------------------------------------------------------------



DATA : BEGIN OF GS_SPFLI,

  CARRID TYPE SPFLI-CARRID,

  CONNID TYPE SPFLI-CONNID,

  END OF GS_SPFLI.



DATA : GT_SPFLI LIKE TABLE OF GS_SPFLI.



DATA : BEGIN OF GS_SFLIGHT10,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  FLDATE TYPE SFLIGHT-FLDATE,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT10.



DATA : GT_SFLIGHT10 LIKE TABLE OF GS_SFLIGHT10.



SELECT CARRID

       CONNID

  FROM SPFLI

  INTO CORRESPONDING FIELDS OF TABLE GT_SPFLI

  WHERE CARRID LIKE 'A%'.



IF GT_SPFLI IS NOT INITIAL.

  SELECT CARRID

         CONNID

         FLDATE

         PRICE

    FROM SFLIGHT

    INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT10

    FOR ALL ENTRIES IN GT_SPFLI

    WHERE CARRID = GT_SPFLI-CARRID

    AND CONNID = GT_SPFLI-CONNID.

ENDIF.



LOOP AT GT_SFLIGHT10 INTO GS_SFLIGHT10.

  WRITE :/ GS_SFLIGHT10-CARRID, GS_SFLIGHT10-CONNID, GS_SFLIGHT10-FLDATE, GS_SFLIGHT10-PRICE.

ENDLOOP.



"-----------------------------------------------------------------------