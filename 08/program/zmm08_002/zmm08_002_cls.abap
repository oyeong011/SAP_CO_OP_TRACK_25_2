
*&---------------------------------------------------------------------*

*&  Include           ZMM08_002_CLS

*&---------------------------------------------------------------------*




CLASS LCL_ALV_EVENT DEFINITION FINAL.

  PUBLIC SECTION.

    METHODS:

      ON_TOOLBAR FOR EVENT TOOLBAR OF CL_GUI_ALV_GRID

        IMPORTING E_OBJECT E_INTERACTIVE,

          ON_USER_COMMAND FOR EVENT USER_COMMAND OF CL_GUI_ALV_GRID

        IMPORTING E_UCOMM,

          ON_DATA_CHANGED FOR EVENT DATA_CHANGED_FINISHED OF CL_GUI_ALV_GRID

        IMPORTING E_MODIFIED ET_GOOD_CELLS.

ENDCLASS.



CLASS LCL_ALV_EVENT IMPLEMENTATION.

  METHOD ON_TOOLBAR.

    DATA: LS_BTN TYPE STB_BUTTON.



    CLEAR LS_BTN.

    LS_BTN-BUTN_TYPE = 3.

    APPEND LS_BTN TO E_OBJECT->MT_TOOLBAR.



    CLEAR LS_BTN.

    LS_BTN-FUNCTION = C_OK_ADD.

    LS_BTN-ICON = ICON_INSERT_ROW.

    LS_BTN-TEXT = '####'.

    LS_BTN-QUICKINFO = 'ADD ITEM'.

    APPEND LS_BTN TO E_OBJECT->MT_TOOLBAR.



    CLEAR LS_BTN.

    LS_BTN-FUNCTION = C_OK_DEL.

    LS_BTN-ICON = ICON_DELETE_ROW.

    LS_BTN-TEXT = '####'.

    LS_BTN-QUICKINFO = 'Delete Item'.

    APPEND LS_BTN TO E_OBJECT->MT_TOOLBAR.



    CLEAR LS_BTN.

    LS_BTN-BUTN_TYPE = 3.

    APPEND LS_BTN TO E_OBJECT->MT_TOOLBAR.



    CLEAR LS_BTN.

    LS_BTN-FUNCTION = C_OK_SAVE.

    LS_BTN-ICON = ICON_SYSTEM_SAVE.

    LS_BTN-TEXT = 'PO##'.

    LS_BTN-QUICKINFO = 'Create PO'.

    APPEND LS_BTN TO E_OBJECT->MT_TOOLBAR.

  ENDMETHOD.



  METHOD ON_USER_COMMAND.



    CASE E_UCOMM.

      WHEN C_OK_ADD.

        PERFORM ADD_ITEM.

      WHEN C_OK_DEL.

        PERFORM DELETE_ITEM.

      WHEN C_OK_SAVE.

        PERFORM CREATE_PO.

    ENDCASE.



  ENDMETHOD.



  METHOD ON_DATA_CHANGED.

    PERFORM REFRESH_ITEM_DERIVED.

  ENDMETHOD.

ENDCLASS.