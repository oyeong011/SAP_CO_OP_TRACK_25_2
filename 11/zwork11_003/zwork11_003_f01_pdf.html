<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZWORK11_003_F01_PDF</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZWORK11_003_F01_PDF</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="code">
"""ZWORK11_002_F01_PDF<br />
FORM SAVE_DATA .<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_DIR_PATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PDF_FILENAME&nbsp;TYPE&nbsp;STRING&nbsp;VALUE&nbsp;'\######.pdf',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_EXCEL_FILENAME&nbsp;TYPE&nbsp;STRING&nbsp;VALUE&nbsp;'\######.xlsx',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PDF_FULLPATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_EXCEL_FULLPATH&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PDF_RLGRAP&nbsp;TYPE&nbsp;RLGRAP-FILENAME,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_EXCEL_RLGRAP&nbsp;TYPE&nbsp;RLGRAP-FILENAME.<br />
<br />
&nbsp;&nbsp;"1.&nbsp;##&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;GET_TEMP_DIRECTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEMP_DIR&nbsp;=&nbsp;LV_DIR_PATH.<br />
<br />
&nbsp;&nbsp;"1-1.&nbsp;####&nbsp;PATH&nbsp;####<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;DIRECTORY_BROWSE<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECTED_FOLDER&nbsp;=&nbsp;LV_DIR_PATH.<br />
<br />
&nbsp;&nbsp;"1-2.&nbsp;###&nbsp;##&nbsp;##&nbsp;PATH&nbsp;##<br />
&nbsp;&nbsp;CONCATENATE&nbsp;LV_DIR_PATH&nbsp;LV_PDF_FILENAME&nbsp;INTO&nbsp;LV_PDF_FULLPATH.<br />
&nbsp;&nbsp;CONCATENATE&nbsp;LV_DIR_PATH&nbsp;LV_EXCEL_FILENAME&nbsp;INTO&nbsp;LV_EXCEL_FULLPATH.<br />
&nbsp;&nbsp;LV_PDF_RLGRAP&nbsp;=&nbsp;LV_PDF_FULLPATH.<br />
&nbsp;&nbsp;LV_EXCEL_RLGRAP&nbsp;=&nbsp;LV_EXCEL_FULLPATH.<br />
<br />
&nbsp;&nbsp;"2.&nbsp;####&nbsp;TEMPLATE<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_WWWDATA&nbsp;TYPE&nbsp;WWWDATATAB.<br />
<br />
&nbsp;&nbsp;"2-1.&nbsp;###&nbsp;##&nbsp;###&nbsp;###&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'WS_FILE_DELETE'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE&nbsp;=&nbsp;LV_PDF_RLGRAP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'###&nbsp;##&nbsp;##'&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"2-2.&nbsp;SAP&nbsp;#&nbsp;######&nbsp;###&nbsp;###&nbsp;#####&nbsp;##<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;FROM&nbsp;WWWDATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;LS_WWWDATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;OBJID&nbsp;=&nbsp;'ZCURR24_TEMPLATE'.<br />
<br />
&nbsp;&nbsp;"2-2-1.&nbsp;####<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'#&nbsp;#######&nbsp;####&nbsp;##&nbsp;#&nbsp;####.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"2-3.&nbsp;SAP&nbsp;#&nbsp;#######&nbsp;##&nbsp;###&nbsp;##&nbsp;PC#&nbsp;####<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'DOWNLOAD_WEB_OBJECT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;KEY&nbsp;=&nbsp;LS_WWWDATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESTINATION&nbsp;=&nbsp;LV_EXCEL_RLGRAP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;|###&nbsp;###&nbsp;{&nbsp;LV_EXCEL_RLGRAP&nbsp;}&nbsp;#&nbsp;#########.|&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'###&nbsp;###&nbsp;####&nbsp;##&nbsp;#####'&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"3.&nbsp;OPEN_EXCEL_EMPLATE<br />
&nbsp;&nbsp;"3-1.&nbsp;EXCEL&nbsp;OLE&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;EXCEL&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKBOOKS&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKBOOK&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WORKSHEET&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SHEETS&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CELL&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_RC&nbsp;TYPE&nbsp;I.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;EXCEL&nbsp;'EXCEL.APPLICATION'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;EXCEL&nbsp;'WORKBOOKS'&nbsp;=&nbsp;WORKBOOKS.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKBOOKS&nbsp;'Open'&nbsp;=&nbsp;WORKBOOK<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_EXCEL_RLGRAP.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;|##&nbsp;##(LV_EXCEL_PATH)#&nbsp;OLE#&nbsp;##&nbsp;#&nbsp;######.&nbsp;SMW0#&nbsp;###&nbsp;###&nbsp;######&nbsp;#####.|<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;STOP.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;EXCEL&nbsp;'ACTIVESHEET'&nbsp;=&nbsp;WORKSHEET.<br />
<br />
<br />
&nbsp;&nbsp;"4.&nbsp;FILL_EXCEL_LINE<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LT_ALV&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;GS_OUTPUT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ALV&nbsp;LIKE&nbsp;GS_OUTPUT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_ROW&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;2.<br />
<br />
&nbsp;&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'########'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'########'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;worksheet&nbsp;'Cells'&nbsp;=&nbsp;cell&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;1&nbsp;#2&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;cell&nbsp;'Value'&nbsp;=&nbsp;'###'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;"NOT&nbsp;EMPTY<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_OUTPUT&nbsp;INTO&nbsp;LS_ALV.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;1#&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-KURST.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;2#&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-FCURR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;3#&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-TCURR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;4#&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-GDATU.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;5#&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;5.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-UKURS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;6#&nbsp;########<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;6.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-FFACT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;7#&nbsp;########<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;7.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-TFACT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;8#&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;8.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-WRITER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;EXCEL&nbsp;9#&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'Cells'&nbsp;=&nbsp;CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;9.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;CELL&nbsp;'Value'&nbsp;=&nbsp;LS_ALV-EDATE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_ROW&nbsp;=&nbsp;LV_ROW&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"Draw&nbsp;borders<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;RANGE&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BORDERS&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERIOR&nbsp;TYPE&nbsp;OLE2_OBJECT,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BORDER_ROW&nbsp;TYPE&nbsp;I.<br />
<br />
<br />
&nbsp;&nbsp;"DRAW&nbsp;HEADER&nbsp;BORDER<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'RANGE'&nbsp;=&nbsp;RANGE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;'A1'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;'I1'.<br />
<br />
&nbsp;&nbsp;"delete&nbsp;header&nbsp;highlight<br />
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;RANGE&nbsp;'Interior'&nbsp;=&nbsp;INTERIOR.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;INTERIOR&nbsp;'ColorIndex'&nbsp;=&nbsp;-4142.&nbsp;&nbsp;"&nbsp;xlNone&nbsp;(###&nbsp;##)<br />
<br />
&nbsp;&nbsp;"draw&nbsp;header&nbsp;border<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;11.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;"DRAW&nbsp;DATA&nbsp;BORDER<br />
&nbsp;&nbsp;&nbsp;&nbsp;"###&nbsp;###&nbsp;(2###)<br />
&nbsp;&nbsp;LV_BORDER_ROW&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_OUTPUT&nbsp;INTO&nbsp;LS_ALV.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA(LV_START_CELL)&nbsp;=&nbsp;|A{&nbsp;LV_BORDER_ROW&nbsp;}|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DATA(LV_END_CELL)&nbsp;=&nbsp;|I{&nbsp;LV_BORDER_ROW&nbsp;}|.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKSHEET&nbsp;'RANGE'&nbsp;=&nbsp;RANGE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;LV_START_CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;LV_END_CELL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;###&nbsp;##&nbsp;###&nbsp;(#&nbsp;##)<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;RANGE&nbsp;'BORDERS'&nbsp;=&nbsp;BORDERS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING&nbsp;#1&nbsp;=&nbsp;11.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;BORDERS&nbsp;'LINESTYLE'&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_BORDER_ROW&nbsp;=&nbsp;LV_BORDER_ROW&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"Set&nbsp;the&nbsp;zoom<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;PAGE_SETTING&nbsp;TYPE&nbsp;OLE2_OBJECT.<br />
&nbsp;&nbsp;GET&nbsp;PROPERTY&nbsp;OF&nbsp;WORKSHEET&nbsp;'PAGESETUP'&nbsp;=&nbsp;PAGE_SETTING.<br />
&nbsp;&nbsp;SET&nbsp;PROPERTY&nbsp;OF&nbsp;PAGE_SETTING&nbsp;'ZOOM'&nbsp;=&nbsp;ABAP_FALSE.<br />
<br />
&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKBOOK&nbsp;'SAVE'.<br />
<br />
&nbsp;&nbsp;"5.&nbsp;PDF#&nbsp;####&nbsp;(##&nbsp;##)<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKBOOK&nbsp;'ExportAsFixedFormat'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#1&nbsp;=&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Type&nbsp;(xlTypePDF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#2&nbsp;=&nbsp;LV_PDF_RLGRAP.&nbsp;"Filename&nbsp;(PDF&nbsp;##)<br />
<br />
<br />
&nbsp;&nbsp;"6.&nbsp;##&nbsp;#&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;WORKBOOK&nbsp;'CLOSE'.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;OF&nbsp;EXCEL&nbsp;'QUIT'.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;WORKBOOK.<br />
&nbsp;&nbsp;FREE&nbsp;OBJECT&nbsp;EXCEL.<br />
<br />
&nbsp;&nbsp;"7.&nbsp;DELETE&nbsp;FILE&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_FRONTEND_SERVICES=&gt;FILE_DELETE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILENAME&nbsp;=&nbsp;LV_EXCEL_FULLPATH<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RC&nbsp;=&nbsp;LV_RC<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_DELETE_FAILED&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_NO_GUI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FILE_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ACCESS_DENIED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UNKNOWN_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NOT_SUPPORTED_BY_GUI&nbsp;=&nbsp;7<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WRONG_PARAMETER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;others&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;|PDF&nbsp;##&nbsp;##&nbsp;##&nbsp;##&nbsp;:&nbsp;{&nbsp;SY-SUBRC&nbsp;}|&nbsp;TYPE&nbsp;'I'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;MESSAGE&nbsp;|PDF&nbsp;###&nbsp;#######:|&nbsp;TYPE&nbsp;'S'.<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750</td>
   </tr>
</table>
</body>
</html>
