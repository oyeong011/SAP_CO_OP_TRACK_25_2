
*&---------------------------------------------------------------------*

*& Report ZEDR23_010

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR23_010.



"***DB TABLE ##***"



DATA : BEGIN OF GS_SCARR,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR.

DATA : GT_SCARR LIKE TABLE OF GS_SCARR.



" SELECT INTO

SELECT CARRID CARRNAME INTO GS_SCARR

  FROM SCARR WHERE CARRID = 'AA'.

ENDSELECT.

BREAK-POINT.



" SELECT SINGLE

SELECT SINGLE CARRID CARRNAME INTO (GS_SCARR-CARRID, GS_SCARR-CARRNAME)

  FROM SCARR WHERE CARRID = 'AB'.

BREAK-POINT.



" SELECT INTO TABLE

SELECT CARRID CARRNAME

  FROM SCARR

  "INTO TABLE GT_SCARR  " <= ### ## # ## ### #### ### ## ##

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

  WHERE CARRID = 'AA'.

BREAK-POINT.



" SELECT APPENDING

" INTO # ### ##### ## # ######

" APPENDING ## ### ## # # ###~

SELECT CARRID CARRNAME

  FROM SCARR

  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR

  WHERE CARRID = 'AB'.

BREAK-POINT.



" WHERE ###

" EQ(=)

" NE(<>)

" LT(<)

" LE(<=)

" GT(>)

" GE(>=)

" BETWEEN A AND B

" LIKE 'A%' : A# ####

" IN ('AA', 'AB') : ##





" RANGE TABLE : header ##

" #### SIGN, OPTION, LOW, HIGH ### ## Structure ##

" SIGN - I : Include

" SIGN - E : Exclude

" CP - '*A' : A# ### ###

" CP - 'A*' : A# #### ###

RANGES GR_SCARR FOR SCARR-CARRID.

GR_SCARR-SIGN = 'I'.

GR_SCARR-OPTION = 'CP'.

GR_SCARR-LOW = '*A'.

APPEND GR_SCARR.





SELECT * FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

  WHERE CARRID IN GR_SCARR.

BREAK-POINT.



CLEAR GR_SCARR.

GR_SCARR-SIGN = 'I'.

GR_SCARR-OPTION = 'EQ'.

GR_SCARR-LOW = 'AA'.

APPEND GR_SCARR.

GR_SCARR-LOW = 'AC'.

APPEND GR_SCARR.



SELECT * FROM SCARR

  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

  WHERE CARRID IN GR_SCARR.

BREAK-POINT.



"GROUPING

" AVG, COUNT, MAX, MIN, SUM, STDDEV, VARIANCE

DATA : BEGIN OF GS_SFLIGHT,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE i,

  END OF GS_SFLIGHT.

DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.



SELECT CARRID CONNID AVG( PRICE ) AS GV_SUM

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

  FROM SFLIGHT GROUP BY CARRID CONNID.

  "HAVING AVG( PRICE ) > 1000.

  "ORDER BY CARRID ASCENDING. " ## ### # # ###~

BREAK-POINT.



DATA : BEGIN OF GS_SFLIGHT2,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT2.

DATA : GT_SFLIGHT2 LIKE TABLE OF GS_SFLIGHT2.



" Subquery

SELECT CARRID CONNID PRICE

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT2

  FROM SFLIGHT

  " FROM SFLIGHT AS A "# ## ## ##

  WHERE CARRID

  IN ( SELECT CARRID

  FROM SPFLI WHERE CARRID = SFLIGHT~CARRID AND CONNID = SFLIGHT~CONNID )

  AND CARRID = 'AA'

  AND CONNID LIKE '00%'.

BREAK-POINT.



" JOIN

" INNER JOIN : #

" LEFT OUTER JOIN : ## ### ## ##, #### ### NULL # ##

" RIGHT OUTER JOIN : ### ### ## ##, ### ### NULL # ##

DATA : BEGIN OF GS_SFLIGHT3,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  CARRNAME TYPE SCARR-CARRNAME,

  END OF GS_SFLIGHT3.

DATA : GT_SFLIGHT3 LIKE TABLE OF GS_SFLIGHT3.



SELECT A~CARRID A~CONNID B~CARRNAME "A## CARRID, CONNID #### B## CARRNAME ###

  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT3

  FROM SFLIGHT AS A

  INNER JOIN SCARR AS B " SFLIGHT # SCARR # JOIN

  ON A~CARRID = B~CARRID " JOIN # ##

  WHERE A~CARRID = 'AA'.



BREAK-POINT.