
*&---------------------------------------------------------------------*

*& Report ZEDR20_015

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR20_015.



DATA: BEGIN OF GS_SCARR,

  ZCHECK,

  CARRID LIKE SCARR-CARRID,

  CARRNAME LIKE SCARR-CARRNAME,

  END OF GS_SCARR.

DATA: GT_SCARR LIKE TABLE OF GS_SCARR.






*SELECT SINGLE CARRID CARRNAME INTO ( GS_SCARR-CARRID, GS_SCARR-CARRNAME )

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*WRITE:/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.



*SELECT CARRID

*        CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AA'.



*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE:/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*SELECT CARRID

*        CARRNAME

*  FROM SCARR

*  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR    " INTO# ## ## # ## ###

*  WHERE CARRID = 'AB'.



*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE:/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*SELECT CARRID

*      CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID BETWEEN 'AA' AND 'AB'.







*SELECT CARRID

*      CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID LIKE 'A%'.



*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE:/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*SELECT CARRID

*      CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN ( 'AA', 'AB' ).   " LIST VALUE



*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE:/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*RANGES GR_SCARR FOR SCARR-CARRID.



*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'BT'.

*GR_SCARR-LOW = 'AA'.

*GR_SCARR-HIGH = 'AB'.

*APPEND GR_SCARR.

*

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'CP'.

*GR_SCARR-LOW = 'A*'.

*APPEND GR_SCARR.



*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'EQ'.

*GR_SCARR-LOW = 'AA'.

*APPEND GR_SCARR.

*

*GR_SCARR-LOW = 'AB'.

*APPEND GR_SCARR.

*

*SELECT * FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE:/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






DATA: BEGIN OF GS_SFLIGHT,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  GV_SUM TYPE I,

  PRICE TYPE SFLIGHT-PRICE,

  CARRNAME TYPE SCARR-CARRNAME,

  FLDATE TYPE SFLIGHT-FLDATE,

  END OF GS_SFLIGHT.

DATA: GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.






*SELECT CARRID

*      CONNID

*      AVG( PRICE ) AS GV_SUM

*  FROM SFLIGHT

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) GE 1000

*  ORDER BY GV_SUM. "CARRID DESCENDING.

*

*SELECT CARRID

*      CONNID

*      PRICE

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  WHERE CARRID IN ( SELECT CARRID

*                      FROM SPFLI

*                      WHERE CARRID = A~CARRID

*                        AND CONNID = A~CONNID )

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.



*SELECT A~CARRID

*      A~CONNID

*      B~CARRNAME

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  INNER JOIN SCARR AS B

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'.

*

*SELECT A~CARRID

*      A~CONNID

*      B~CARRNAME

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  LEFT OUTER JOIN SCARR AS B

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'.






DATA: BEGIN OF GS_SPFLI,

  CARRID TYPE SPFLI-CARRID,

  CONNID TYPE SPFLI-CONNID,

  END OF GS_SPFLI.

DATA: GT_SPFLI LIKE TABLE OF GS_SPFLI.



SELECT CARRID

      CONNID

  FROM SPFLI

  INTO CORRESPONDING FIELDS OF TABLE GT_SPFLI

  WHERE CARRID LIKE 'A%'.



IF GT_SPFLI IS NOT INITIAL.

  SELECT CARRID

        CONNID

        FLDATE

        PRICE

    FROM SFLIGHT

    INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

    FOR ALL ENTRIES IN GT_SPFLI

    WHERE CARRID = GT_SPFLI-CARRID

    AND CONNID = GT_SPFLI-CONNID.

ELSE.

  WRITE:/ '## #### ####.'.

ENDIF.



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE:/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

ENDLOOP.