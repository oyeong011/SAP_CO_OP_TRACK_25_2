
*&---------------------------------------------------------------------*

*&  Include           ZWORK21_001_TOP

*&---------------------------------------------------------------------*






"### ##

TABLES : ZTCURR21, SSCRFIELDS.



"SELECTION SCREEN## ### #### ## # ### ### ##

DATA : G_FUNCTION_KEY TYPE SMP_DYNTXT.

SELECTION-SCREEN : FUNCTION KEY 1.



"EXCEL ### 1## #### ### #### ## ##

DATA : GV_DOWNLOAD_REQUEST TYPE ABAP_BOOL.



"## ##### RAW ### ##

DATA : T_RAW_EXCEL TYPE TABLE OF ALSMEX_TABLINE,

       S_RAW_EXCEL TYPE ALSMEX_TABLINE.





"### ## ##



"SMW0# ### ##### KEY##

DATA : GS_KEY TYPE WWWDATATAB.



"###, ##, #### # ##

DATA : GV_FILE TYPE STRING,

       GV_PATH TYPE STRING,

       GV_FULLPATH TYPE STRING.

DATA : GV_DEST TYPE RLGRAP-FILENAME VALUE 'C:\'.



"## ### ##

DATA : LV_ANSWER TYPE C.





"## EXCEL### ##

DATA : LT_EXCEL TYPE TABLE OF ALSMEX_TABLINE,

       LS_EXCEL TYPE ALSMEX_TABLINE.



"##### ## ## #### ## ##

DATA: LT_FIELDNAMES TYPE STANDARD TABLE OF STRING.





"ALV# ## # ## ### ##

DATA : BEGIN OF GS_TCURR,

  KURST LIKE ZTCURR21-KURST,

  FCURR LIKE ZTCURR21-FCURR,

  TCURR LIKE ZTCURR21-TCURR,

  GDATU LIKE ZTCURR21-GDATU,

  UKURS LIKE ZTCURR21-UKURS,

  FFACT LIKE ZTCURR21-FFACT,

  TFACT LIKE ZTCURR21-TFACT,

  MODIFER LIKE ZTCURR21-MODIFER,

  EDATE LIKE ZTCURR21-EDATE,

  END OF GS_TCURR.



"ALV# ##/### ## ### ## ### ###

DATA : GT_TCURR LIKE TABLE OF GS_TCURR.



"### ### ### OK_CODE

DATA : OK_CODE TYPE SY-UCOMM.



"ALV_CONTAINER # GRID ##

DATA : GC_DOCKING TYPE REF TO CL_GUI_DOCKING_CONTAINER.

"ALV GRID ### ##

DATA : GC_GRID TYPE REF TO CL_GUI_ALV_GRID.

"ALV LAYOUT VARIANT ##

DATA : GS_VARIANT TYPE DISVARIANT.



"FIELD CATALOG ## ##

DATA : GS_FIELDCAT TYPE LVC_S_FCAT.

DATA : GT_FIELDCAT TYPE LVC_T_FCAT.



"ALV LAYOUT ## ##

DATA : GS_LAYOUT TYPE LVC_S_LAYO.



"ALV_## ## ##

DATA : GS_SORT TYPE LVC_S_SORT.

DATA : GT_SORT TYPE LVC_T_SORT.



"EXCEL ## ## ## ##

DATA : LV_FILENAME TYPE STRING.

DATA : LV_PATH TYPE STRING.

DATA : LV_FULLPATH TYPE STRING.



"REFRESH ## ###

DATA : LS_STABLE TYPE LVC_S_STBL.





"SAVE ## ###

DATA : GS_SAVE LIKE ZTCURR21.

DATA : GT_SAVE LIKE TABLE OF GS_SAVE.

DATA : GO_EVENT TYPE REF TO EVENT.