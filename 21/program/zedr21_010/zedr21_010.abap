
*&---------------------------------------------------------------------*

*& Report ZEDR21_010

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR21_010.



"SELECT DB## SELECT ### ### # ##

"SELECT * # ## ### ## ## ### ###

"SELECT FIELD # ### single line## ####

"View# ### # ## #### ### join ## or ### ### ## ##

"Ranges #### internal table# ##### ### !

"CP# ## ####

"For Entries # # ### NULL ### ## LOOP -> Memory Dump





"1)### INTO SELECT single_line






*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME INTO GS_SCARR

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARNAME.

*ENDSELECT.






"### INTO SELECT (   ) ##




*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT SINGLE CARRID CARRNAME INTO ( GS_SCARR-CARRID , GS_SCARR-CARRNAME ) "## ### TARGET# ## ## ##

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.






"2)INTERNAL TABLE ## ### ## # ## ### ### ##




*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C, "### ### ZCHECK# ###### CARID # A# ##

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.

*

*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C, "### ### ZCHECK# ###### CARID # A# ##

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR "CORRESPONDING FIELDS OF ## ## #### ##

*  WHERE CARRID = 'AA'.

*

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.





*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C, "### ### ZCHECK# ###### CARID # A# ##

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR "CORRESPONDING FIELDS OF ## ## #### ##

*  WHERE CARRID = 'AA'.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AB'. "### ### # ## ### #### AB# ##

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"APPENDING ##






*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C, "### ### ZCHECK# ###### CARID # A# ##

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR "CORRESPONDING FIELDS OF ## ## #### ##

*  WHERE CARRID = 'AA'.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR "### ## # ####

*  WHERE CARRID = 'AB'. "### ### # ## ### #### AB# ##

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"WHERE ## 1) BETWEEN A AND B




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID BETWEEN 'AA' AND 'AB'.

*

*

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.








"WHERE ## STRING ## LIKE "a%" ### A## # ##




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID LIKE 'A%'.

*

*

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"LIST VALUE




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN ( 'AA', 'AC' ).

*

*

* LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"###### ### ##### ##### RANGE ### ## ### ##






*RANGES GR_SCARR FOR SCARR-CARRID.

*

*CLEAR : GR_SCARR.

*

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'CP'.

*GR_SCARR-LOW = '*A'.

*APPEND GR_SCARR.

*

*DATA : BEGIN OF GS_SCARR.

*  INCLUDE TYPE SCARR.

*DATA : END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT * FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*

*  LOOP AT GT_SCARR INTO GS_SCARR.

*    WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*    ENDLOOP.



*RANGES GR_SCARR FOR SCARR-CARRID.

*

*CLEAR : GR_SCARR.

*

*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

* END OF GS_SCARR.

*

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'CP'.

*GR_SCARR-LOW = '*A'.

*APPEND GR_SCARR.

*

*GR_SCARR-LOW = 'AC'.

*APPEND GR_SCARR.

*

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*

*  LOOP AT GT_SCARR INTO GS_SCARR.

*    WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*    ENDLOOP.








"GROUPING






*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT CARRID

*      CONNID

*      AVG( PRICE ) AS GV_SUM "AS ### ### ### ###

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*  ENDLOOP.






"GROUP BY # ### DATA# PRICE # 1000 ### #### ## ###?




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT CARRID

*      CONNID

*      AVG( PRICE ) AS GV_SUM "AS ### ### ### ###

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*  ENDLOOP.



*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT CARRID

*      CONNID

*      AVG( PRICE ) AS GV_SUM "AS ### ### ### ###

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY CARRID DESCENDING.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*  ENDLOOP.






"PRICE FIELD# SORT ## ###?




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT CARRID

*      CONNID

*      AVG( PRICE ) AS GV_SUM "AS ### ### ### ###

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY GV_SUM. "PIRCE

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*  ENDLOOP.






"NESTED QUERY






*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT CARRID

*      CONNID

*      PRICE

*

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  WHERE CARRID IN ( SELECT CARRID

*                    FROM SPFLI

*                    WHERE CARRID = A~CARRID

*                      AND CONNID = A~CONNID )

*

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.

*

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-PRICE.

*  ENDLOOP.






"JOIN - INNERJOIN






*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  CARRNAME TYPE SCARR-CARRNAME,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT A~CARRID

*      A~CONNID

*      B~CARRNAME "JOIN # SELECT #### ##### ## ##### #### #

*

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  INNER JOIN SCARR AS B

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'. " WHERE ### ON## #### ### WHERE## ## ####, # #### #### ## ON #### JOIN

*

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

*  ENDLOOP.






"JOIN- OUTERJOIN




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  CARRNAME TYPE SCARR-CARRNAME,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT A~CARRID

*      A~CONNID

*      B~CARRNAME "JOIN # SELECT #### ##### ## ##### #### #

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A "##

*  LEFT OUTER JOIN SCARR AS B "JOIN ### ## ### #### SELECT ### ##

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'. " WHERE ### ON## #### ### WHERE## ## ####, # #### #### ## ON #### JOIN

*

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

*  ENDLOOP.






"FOR ALL ENTRIES

DATA : BEGIN OF GS_SPFLI ,

  CARRID TYPE SPFLI-CARRID,

  CONNID TYPE SPFLI-CONNID,

  END OF GS_SPFLI.

DATA : GT_SPFLI LIKE TABLE OF GS_SPFLI.



DATA : BEGIN OF GS_SFLIGHT ,

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  FLDATE TYPE SFLIGHT-FLDATE,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT.

DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.



SELECT CARRID

      CONNID

  FROM SPFLI

  INTO CORRESPONDING FIELDS OF TABLE GT_SPFLI

  WHERE CARRID LIKE 'A%'.



 SELECT CARRID

        CONNID

        FLDATE

        PRICE

   FROM SFLIGHT

   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

   FOR ALL ENTRIES IN GT_SPFLI

   WHERE CARRID = GT_SPFLI-CARRID

   AND CONNID = GT_SPFLI-CONNID.



 LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

   WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

   ENDLOOP.