<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=ISO-8859-1" />
<title>ZMMR01_020_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZMMR01_020_F01</h2>
<h3> Description: </h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;INCLUDE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZMMR01_020_F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;INITIALIZATION<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INITIALIZATION .<br />
&nbsp;&nbsp;P_BLDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;P_EBELN&nbsp;=&nbsp;4500000001.<br />
&nbsp;&nbsp;P_WERKS&nbsp;=&nbsp;1000.<br />
&nbsp;&nbsp;GS_HEADER-WIDTH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;30.<br />
&nbsp;&nbsp;GS_HEADER-WIDTH_PIX&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;GS_HEADER-HEADING&nbsp;&nbsp;&nbsp;=&nbsp;'MY&nbsp;DOCUMENTS'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;SELECTION_SCREEN_OUTPUT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECTION_SCREEN_OUTPUT .<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SCREEN-GROUP1&nbsp;=&nbsp;'M1'.&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_R1&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-ACTIVE&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;P_R2&nbsp;=&nbsp;'X'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-ACTIVE&nbsp;=&nbsp;'0'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CHECK_MANDATORY<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_MANDATORY .<br />
&nbsp;&nbsp;IF&nbsp;P_R1&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_EBELN&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S008&nbsp;WITH&nbsp;TEXT-M01&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_WERKS&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S008&nbsp;WITH&nbsp;TEXT-M02&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_BLDAT&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S008&nbsp;WITH&nbsp;TEXT-M03&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;P_R2&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_EBELN&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S008&nbsp;WITH&nbsp;TEXT-M01&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_WERKS&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S008&nbsp;WITH&nbsp;TEXT-M02&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CHECK_SELECTION_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_SELECTION_DATA .<br />
&nbsp;&nbsp;IF&nbsp;P_R1&nbsp;=&nbsp;C_X.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_MODE&nbsp;=&nbsp;C_CRUD.<br />
&nbsp;&nbsp;ELSEIF&nbsp;P_R2&nbsp;=&nbsp;C_X.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_MODE&nbsp;=&nbsp;C_DISP.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CHECK_PURCHASE_ORDER_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_PURCHASE_ORDER_DATA .<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_EKKO<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKKO01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;P_EBELN.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S007&nbsp;WITH&nbsp;TEXT-M01&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_EKPO<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKPO01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;P_EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;P_WERKS.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S007&nbsp;WITH&nbsp;TEXT-M02&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_LFA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZLFA1_01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;=&nbsp;GS_EKKO-LIFNR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S007&nbsp;WITH&nbsp;TEXT-M04&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_LFB1<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZLFB1_01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;=&nbsp;GS_EKKO-LIFNR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S007&nbsp;WITH&nbsp;TEXT-M04&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_LFM1<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZLFM1_01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;=&nbsp;GS_EKKO-LIFNR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S007&nbsp;WITH&nbsp;TEXT-M04&nbsp;DISPLAY&nbsp;LIKE&nbsp;C_E.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_DATA .<br />
&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;C_CRUD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_PO_DATA.<br />
&nbsp;&nbsp;ELSEIF&nbsp;GV_MODE&nbsp;=&nbsp;C_DISP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_GR_DATA.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CALL_SCREEN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CALL_SCREEN .<br />
&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;C_CRUD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;200.<br />
&nbsp;&nbsp;ELSEIF&nbsp;GV_MODE&nbsp;=&nbsp;C_DISP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;100.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;INIT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INIT_DATA .<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_PO_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_PO_DATA .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISP_100.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_EKPO&nbsp;INTO&nbsp;GS_EKPO.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISP_100.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;PO&nbsp;ITEM<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_EKPO&nbsp;TO&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-WAERS&nbsp;=&nbsp;GS_EKKO-WAERS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_GR_QTY&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GS_EKPO-EBELN&nbsp;GS_EKPO-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_DISP_100-GR_DONE_QTY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-REM_QTY&nbsp;=&nbsp;GS_EKPO-MENGE&nbsp;-&nbsp;GS_DISP_100-GR_DONE_QTY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISP_100&nbsp;TO&nbsp;GT_DISP_100.<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_GR_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_GR_DATA .<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMSEG01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_MSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;@P_EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;@P_WERKS.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GT_MSEG&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'####&nbsp;###&nbsp;####&nbsp;##&nbsp;#####&nbsp;####&nbsp;####.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMKPF01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_MKPF<br />
&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;ALL&nbsp;ENTRIES&nbsp;IN&nbsp;@GT_MSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MBLNR&nbsp;=&nbsp;@GT_MSEG-MBLNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MJAHR&nbsp;=&nbsp;@GT_MSEG-MJAHR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GT_MKPF&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'####&nbsp;###&nbsp;####&nbsp;##&nbsp;#####&nbsp;####&nbsp;####.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;LIST-PROCESSING.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CREATE_OBJECT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT USING    PV_CONTAINER_NAME TYPE C<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PV_CUSTOM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_CUSTOM_CONTAINER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PV_GRID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;"&nbsp;CUSTOM&nbsp;CONTAINER&nbsp;##<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;PV_CUSTOM<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;PV_CONTAINER_NAME.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'CUSTOM&nbsp;CONTAINER&nbsp;##&nbsp;##'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV&nbsp;GRID&nbsp;##<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;PV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;PV_CUSTOM.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;GRID&nbsp;##&nbsp;##'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;FIELD_CATALOG<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FIELD_CATALOG .<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT,GT_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'LINE'.<br />
&nbsp;&nbsp;GS_FIELDCAT-ICON&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;GS_FIELDCAT-STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_BUTTON.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'L_CHECK'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'OK'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CHECKBOX&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'COLOR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-ICON&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'EBELN'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'PO##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;15.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-NO_ZERO&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'LGORT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'LGORT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;=&nbsp;'GR_QTY'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'REM_QTY'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;PO&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'PO##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.&nbsp;&nbsp;&nbsp;"&nbsp;EBAN#&nbsp;##<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'GR_DONE_QTY'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;###<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'DMBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;###<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'PRDAT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'PRDAT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;FIELD_CATALOG_DISP<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FIELD_CATALOG_DISP .<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT,&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;"&nbsp;1.&nbsp;####<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'L_CHECK'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CHECKBOX&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;2.&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'REMARK'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;3.&nbsp;PO##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'EBELN'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'PO##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;15.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;4.&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-NO_ZERO&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;5.&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;16.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;6.&nbsp;###<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;7.&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'LGORT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'LGORT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;8.&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'GR_DONE_QTY'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'MENGE'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;9.&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;10.&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;11.&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'DMBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;12.&nbsp;##<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;13.&nbsp;####<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;GS_FIELDCAT-SCRTEXT_M&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;"&nbsp;14.&nbsp;###<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;&nbsp;&nbsp;=&nbsp;'PRDAT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;&nbsp;&nbsp;=&nbsp;'ZEKPO01'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;&nbsp;&nbsp;=&nbsp;'PRDAT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;SET_FIELDCAT_FI<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_FIELDCAT_FI .<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT&nbsp;,&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'BUZEI'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'PK'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'BSCHL'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'##/#####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'SHKZG'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;&nbsp;14.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'HKONT'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'SGTXT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;&nbsp;30.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'####&nbsp;##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WRBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT_MASK&nbsp;=&nbsp;'==RR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-DO_SUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;&nbsp;20.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'####&nbsp;##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'DMBTR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS_D'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT_MASK&nbsp;=&nbsp;'==RR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-DO_SUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;&nbsp;20.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'##'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WAERS_D'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MWSKZ'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_LAYOUT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_LAYOUT .<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;=&nbsp;'CELLTAB'.<br />
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;=&nbsp;'X'.&nbsp;"&nbsp;###&nbsp;##&nbsp;###<br />
&nbsp;&nbsp;GS_LAYOUT-NO_TOOLBAR&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GS_VARIANT-USERNAME&nbsp;=&nbsp;SY-UNAME.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CLASS_EVENT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CLASS_EVENT .<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_EVENT.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_TOOLBAR&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_USER_COMMAND&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_HOTSPOT_CLICK&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_DOUBLE_CLICK&nbsp;FOR&nbsp;GC_GRID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;REGISTER_EDIT_EVENT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
&nbsp;&nbsp;.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_BUTTON_CLICK&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_DATA_CHANGED&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_DATA_CHANGED_FINISHED&nbsp;FOR&nbsp;GC_GRID.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_DISPLAY<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_DISPLAY  USING    PT_TABLE TYPE STANDARD TABLE.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BUFFER_ACTIVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_BYPASSING_BUFFER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_CONSISTENCY_CHECK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_DEFAULT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_PRINT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SPECIAL_GROUPS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;=&nbsp;GT_EXCLUDE<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_HYPERLINK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ALV_GRAPHICS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_EXCEPT_QINFO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IR_SALV_ADAPTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PT_TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;=&nbsp;GT_FIELDCAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_SORT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;IMPLEMENT&nbsp;SUITABLE&nbsp;ERROR&nbsp;HANDLING&nbsp;HERE<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;REGISTER_EDIT_EVENT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_HANDLER_DATA_CHANGED<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_HANDLER_DATA_CHANGED  USING    P_DATA_CHANGED TYPE REF TO CL_ALV_CHANGED_DATA_PROTOCOL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_ONF4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_ONF4_BEFORE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_ONF4_AFTER<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_UCOMM.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_MODI&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_MAT&nbsp;&nbsp;TYPE&nbsp;ZMAT01.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_GR_QTY&nbsp;TYPE&nbsp;ZEKPO01-MENGE.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;GV_QTY_TEXT&nbsp;TYPE&nbsp;C&nbsp;LENGTH&nbsp;20&nbsp;VALUE&nbsp;'GV_QTY'.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;P_DATA_CHANGED-&gt;MT_GOOD_CELLS&nbsp;INTO&nbsp;LS_MODI.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_MODI-FIELDNAME&nbsp;=&nbsp;'GR_QTY'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_GR_QTY&nbsp;=&nbsp;LS_MODI-VALUE.&nbsp;&nbsp;"&nbsp;####&nbsp;###&nbsp;####<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;LS_MODI-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LV_GR_QTY&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ERROR_FLAG&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;RESET_CELL&nbsp;USING&nbsp;P_DATA_CHANGED&nbsp;LS_MODI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;LV_GR_QTY&nbsp;&gt;&nbsp;GS_DISP_100-REM_QTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_ERROR_FLAG&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;RESET_CELL&nbsp;USING&nbsp;P_DATA_CHANGED&nbsp;LS_MODI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;LS_MODI-ROW_ID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-GR_QTY&nbsp;=&nbsp;LV_GR_QTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-DMBTR&nbsp;=&nbsp;GS_DISP_100-GR_QTY&nbsp;*&nbsp;GS_DISP_100-NETPR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISP_100&nbsp;FROM&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;LS_MODI-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISP_100&nbsp;TO&nbsp;GS_EKPO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_EKPO&nbsp;FROM&nbsp;GS_EKPO&nbsp;INDEX&nbsp;LS_MODI-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;LS_MODI-FIELDNAME&nbsp;=&nbsp;'L_CHECK'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;LS_MODI-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-L_CHECK&nbsp;=&nbsp;LS_MODI-VALUE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISP_100-L_CHECK&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-COLOR&nbsp;=&nbsp;ICON_YELLOW_LIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-COLOR&nbsp;=&nbsp;ICON_GREEN_LIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISP_100&nbsp;FROM&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;LS_MODI-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_DATA_CHANGED_FINISHED<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_DATA_CHANGED_FINISHED  USING    P_E_MODIFIED<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_ET_GOOD_CELLS.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH.<br />
&nbsp;&nbsp;CASE&nbsp;GV_ERROR_FLAG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'1'.&nbsp;MESSAGE&nbsp;'#####&nbsp;0##&nbsp;#####'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'2'.&nbsp;MESSAGE&nbsp;'#####&nbsp;##&nbsp;###&nbsp;###&nbsp;#&nbsp;####'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;GV_ERROR_FLAG&nbsp;=&nbsp;0.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_HEADER_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_HEADER_DATA .<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_EKKO&nbsp;TO&nbsp;GS_HEADER_100.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_LFA1&nbsp;TO&nbsp;GS_HEADER_100.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_LFB1&nbsp;TO&nbsp;GS_HEADER_100.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_LFM1&nbsp;TO&nbsp;GS_HEADER_100.<br />
&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;C_CRUD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-MODE_TX&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BUDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BLDAT&nbsp;=&nbsp;P_BLDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_EKPO&nbsp;INTO&nbsp;GS_EKPO&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_EKPO&nbsp;TO&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-BUDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-LINE&nbsp;=&nbsp;'@16@'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-WERKS&nbsp;=&nbsp;GS_EKPO-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BWART&nbsp;=&nbsp;'101'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BLART&nbsp;=&nbsp;'WE'.<br />
&nbsp;&nbsp;ELSEIF&nbsp;GV_MODE&nbsp;=&nbsp;C_DISP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_EKPO&nbsp;INTO&nbsp;GS_EKPO&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_EKPO&nbsp;TO&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-WERKS&nbsp;=&nbsp;GS_EKPO-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BLDAT&nbsp;=&nbsp;GS_MKPF-BLDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BUDAT&nbsp;=&nbsp;GS_MKPF-BUDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BWART&nbsp;=&nbsp;102.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-MODE_TX&nbsp;=&nbsp;'####&nbsp;#&nbsp;##'.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_DISPLAY_DATA .<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;REFRESH<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH .<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_STABLE<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_BUTTON_CLICK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_BUTTON_CLICK  USING    PS_COL_ID TYPE LVC_S_COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_ROW_NO&nbsp;TYPE&nbsp;LVC_S_ROID.<br />
&nbsp;&nbsp;IF&nbsp;PS_COL_ID-FIELDNAME&nbsp;=&nbsp;'LINE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_CURR_INDEX&nbsp;=&nbsp;PS_ROW_NO-ROW_ID.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DISPLAY_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;FLUSH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;UPDATE_VIEW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;SCREEN.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CHECK_SCREEN_VALDATION<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_SCREEN_VALDATION .<br />
&nbsp;&nbsp;IF&nbsp;GS_DISP_100-GR_QTY&nbsp;&lt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'#####&nbsp;0##&nbsp;#####'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-GR_QTY&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GS_DISP_100-GR_QTY&nbsp;&gt;&nbsp;GS_DISP_100-REM_QTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'#####&nbsp;####&nbsp;####&nbsp;###&nbsp;###'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-GR_QTY&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;RESET_CELL<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;P_LS_MODI&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM RESET_CELL USING P_DATA_CHANGED TYPE REF TO CL_ALV_CHANGED_DATA_PROTOCOL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_MODI&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;LVC_S_MODI.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;P_DATA_CHANGED-&gt;MODIFY_CELL<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PS_MODI-ROW_ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FIELDNAME&nbsp;=&nbsp;PS_MODI-FIELDNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_VALUE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;MODIFY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_DATA .<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_NUM&nbsp;TYPE&nbsp;I&nbsp;VALUE&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;GV_MODE&nbsp;=&nbsp;C_CRUD.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;WHERE&nbsp;REM_QTY&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;#####&nbsp;#######&nbsp;##&nbsp;##&nbsp;##&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-LINE&nbsp;=&nbsp;LV_NUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISP_100-REM_QTY&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;GT_DISP_100&nbsp;INDEX&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTINUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-COLOR&nbsp;=&nbsp;ICON_YELLOW_LIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-WERKS&nbsp;=&nbsp;GS_HEADER_100-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_WERKS_TEXT&nbsp;USING&nbsp;GS_DISP_100-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_DISP_100-WERKS_TX.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_LGORT_TEXT&nbsp;USING&nbsp;GS_DISP_100-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-LGORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_DISP_100-LGORT_TX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_MATKL&nbsp;USING&nbsp;GS_DISP_100-MATNR&nbsp;CHANGING&nbsp;GS_DISP_100-MATKL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISP_100&nbsp;FROM&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_NUM&nbsp;=&nbsp;LV_NUM&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;ELSEIF&nbsp;GV_MODE&nbsp;=&nbsp;C_DISP.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_DISP_100,&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;POST_GOODS_RECEIPT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM POST_GOODS_RECEIPT .<br />
&nbsp;&nbsp;DATA&nbsp;LV_ANSWER&nbsp;TYPE&nbsp;C.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_MBLNR&nbsp;TYPE&nbsp;ZMKPF01-MBLNR.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_MKPF&nbsp;,&nbsp;GT_MKPF&nbsp;,&nbsp;GS_MSEG&nbsp;,&nbsp;GT_MSEG.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISP_100-L_CHECK&nbsp;&lt;&gt;&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;|&nbsp;####:&nbsp;{&nbsp;SY-TABIX&nbsp;}&nbsp;###&nbsp;#####&nbsp;##&nbsp;###&nbsp;####|&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZMBELN01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;=&nbsp;'01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_MBLNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'####&nbsp;##'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;GS_HEADER_100-MBLNR&nbsp;=&nbsp;LV_MBLNR.<br />
&nbsp;&nbsp;"&nbsp;######<br />
&nbsp;&nbsp;GS_MKPF-MBLNR&nbsp;=&nbsp;GS_HEADER_100-MBLNR.<br />
&nbsp;&nbsp;GS_MKPF-BLDAT&nbsp;=&nbsp;GS_HEADER_100-BLDAT.<br />
&nbsp;&nbsp;GS_MKPF-BUDAT&nbsp;=&nbsp;GS_HEADER_100-BUDAT.<br />
&nbsp;&nbsp;GS_MKPF-BLART&nbsp;=&nbsp;GS_HEADER_100-BLART.<br />
&nbsp;&nbsp;GS_MKPF-MJAHR&nbsp;=&nbsp;GS_HEADER_100-BUDAT(4).<br />
&nbsp;&nbsp;GS_MKPF-CRNAME&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;GS_MKPF-CRDATE&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_MKPF-CRZEIT&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISP_100-GR_QTY&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MBLNR&nbsp;=&nbsp;GS_HEADER_100-MBLNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MJAHR&nbsp;=&nbsp;GS_HEADER_100-BUDAT(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-ZEILE&nbsp;=&nbsp;SY-TABIX&nbsp;*&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MATNR&nbsp;=&nbsp;GS_DISP_100-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-WERKS&nbsp;=&nbsp;GS_DISP_100-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-LGORT&nbsp;=&nbsp;GS_DISP_100-LGORT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-LIFNR&nbsp;=&nbsp;GS_HEADER_100-LIFNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-WAERS&nbsp;=&nbsp;GS_DISP_100-WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MENGE&nbsp;=&nbsp;GS_DISP_100-GR_QTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-DMBTR&nbsp;=&nbsp;GS_DISP_100-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MEINS&nbsp;=&nbsp;GS_DISP_100-MEINS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-EBELN&nbsp;=&nbsp;GS_HEADER_100-EBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-GJAHR&nbsp;=&nbsp;GS_HEADER_100-BUDAT(4).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-SHKZG&nbsp;=&nbsp;GS_HEADER_100-SHKZG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-BWART&nbsp;=&nbsp;GS_HEADER_100-BWART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSEG&nbsp;TO&nbsp;GT_MSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;POST_FI_DOCUMENT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM POST_FI_DOCUMENT .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_BUZEI&nbsp;TYPE&nbsp;ZBSEG01-BUZEI&nbsp;VALUE&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BELNR&nbsp;TYPE&nbsp;ZBSEG01-BELNR.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;&nbsp;LS_MAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZMAT01.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_KTOPL&nbsp;TYPE&nbsp;ZSKA1_01-KTOPL&nbsp;VALUE&nbsp;'ZCOA',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_KTOSL&nbsp;TYPE&nbsp;ZSKA1_01-KTOSL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BKLAS&nbsp;TYPE&nbsp;ZSKA1_01-BKLAS&nbsp;VALUE&nbsp;'3000'.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LT_RSEG&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZRSEG01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_RSEG&nbsp;TYPE&nbsp;ZRSEG01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_RBKP&nbsp;TYPE&nbsp;ZRBKP01.<br />
<br />
DATA : LV_STR_PR   TYPE ZBSEG01-WRBTR, "## ##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PO_PR&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-WRBTR,&nbsp;"PO&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_RATE_IR&nbsp;&nbsp;TYPE&nbsp;ZRBKP01-KURSF,&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_RATE_GR&nbsp;&nbsp;TYPE&nbsp;ZRBKP01-KURSF,&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_GR_QTY&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZMSEG01-MENGE,&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_GRIR_FCY&nbsp;TYPE&nbsp;ZBSEG01-WRBTR,&nbsp;"GR/IR&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_GRIR_LCY&nbsp;TYPE&nbsp;ZBSEG01-DMBTR,&nbsp;"GR/IR&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_STD_FCY&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-WRBTR,&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_STD_LCY&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-DMBTR,&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PRD_FCY&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-WRBTR,&nbsp;"###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PRD_LCY&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-DMBTR,&nbsp;"###&nbsp;##<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_KDM_LCY&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-DMBTR.&nbsp;"###<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;PO#&nbsp;####&nbsp;#####&nbsp;###&nbsp;##&nbsp;##&nbsp;##<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZRSEG01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT_RSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;GS_HEADER_100-EBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_RSEG&nbsp;INTO&nbsp;LS_RSEG&nbsp;INDEX&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;KURSF<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZRBKP01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_RATE_IR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;BELNR&nbsp;=&nbsp;LS_RSEG-BELNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GJAHR&nbsp;=&nbsp;LS_RSEG-GJAHR.<br />
<br />
&nbsp;&nbsp;&nbsp;LV_RATE_GR&nbsp;=&nbsp;GS_HEADER_100-KURSF.<br />
<br />
&nbsp;&nbsp;&nbsp;IF&nbsp;LV_RATE_IR&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_RATE_IR&nbsp;=&nbsp;LV_RATE_GR.<br />
&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GS_HEADER_100-WAERS&nbsp;&lt;&gt;&nbsp;C_WAERS_D.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_RATE_GR&nbsp;=&nbsp;LV_RATE_GR&nbsp;*&nbsp;'0.01'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_RATE_IR&nbsp;=&nbsp;LV_RATE_IR&nbsp;*&nbsp;'0.01'.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####&nbsp;##&nbsp;4900000000~&nbsp;(04)<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_NEW_BELNR&nbsp;USING&nbsp;C_NR_FI_GR&nbsp;CHANGING&nbsp;LV_BELNR&nbsp;.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;####<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_BKPF-BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
&nbsp;&nbsp;GS_BKPF-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;GS_BKPF-GJAHR&nbsp;=&nbsp;SY-DATUM(4).<br />
&nbsp;&nbsp;GS_BKPF-BLART&nbsp;=&nbsp;'WE'.<br />
&nbsp;&nbsp;GS_BKPF-BLDAT&nbsp;=&nbsp;GS_HEADER_100-BLDAT.<br />
&nbsp;&nbsp;GS_BKPF-BUDAT&nbsp;=&nbsp;GS_HEADER_100-BUDAT.<br />
&nbsp;&nbsp;IF&nbsp;GS_HEADER_100-WAERS&nbsp;&lt;&gt;&nbsp;C_WAERS_D.<br />
&nbsp;&nbsp;&nbsp;GS_BKPF-KURSF&nbsp;=&nbsp;LV_RATE_GR.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;GS_BKPF-KURSF&nbsp;=&nbsp;C_KURSF_TEMP.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;GS_BKPF-WAERS&nbsp;=&nbsp;GS_HEADER_100-WAERS.<br />
&nbsp;&nbsp;GS_BKPF-TCODE&nbsp;=&nbsp;'MIGO'.<br />
&nbsp;&nbsp;GS_BKPF-XBLNR&nbsp;=&nbsp;GS_HEADER_100-MBLNR.<br />
&nbsp;&nbsp;GS_BKPF-CRNAME&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;GS_BKPF-CPUDT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_BKPF-CPUTM&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;LT_RSEG.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MSEG&nbsp;INTO&nbsp;GS_MSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR:&nbsp;LS_MAT&nbsp;.<br />
<br />
<br />
"---------------------------------------------------------<br />
" ## ## ##<br />
"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMAT01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LS_MAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_STR_PR&nbsp;=&nbsp;LS_MAT-STPRS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;NETPR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_PO_PR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKPO01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;GS_HEADER_100-EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
"---------------------------------------------------------<br />
"  #### GR/IR<br />
"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_GR_QTY&nbsp;=&nbsp;GS_MSEG-MENGE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_GRIR_FCY&nbsp;=&nbsp;LV_PO_PR&nbsp;*&nbsp;LV_GR_QTY.&nbsp;"##&nbsp;###&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_GRIR_LCY&nbsp;=&nbsp;LV_GRIR_FCY&nbsp;*&nbsp;LV_RATE_IR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_STD_FCY&nbsp;=&nbsp;LV_STR_PR&nbsp;*&nbsp;LV_GR_QTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_STD_LCY&nbsp;=&nbsp;LV_STD_FCY&nbsp;*&nbsp;LV_RATE_GR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_PRD_FCY&nbsp;=&nbsp;(&nbsp;LV_STR_PR&nbsp;-&nbsp;LV_PO_PR&nbsp;)&nbsp;*&nbsp;LV_GR_QTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_PRD_LCY&nbsp;=&nbsp;LV_PRD_FCY&nbsp;*&nbsp;LV_RATE_GR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_KDM_LCY&nbsp;=&nbsp;(&nbsp;LV_GRIR_FCY&nbsp;*&nbsp;LV_RATE_GR&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;(&nbsp;LV_GRIR_FCY&nbsp;*&nbsp;LV_RATE_IR&nbsp;).<br />
"---------------------------------------------------------<br />
" GR/IR Cr (##)<br />
"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_KTOSL&nbsp;=&nbsp;'WRX'.&nbsp;"GR/IR&nbsp;CLEARING<br />
"---------------------------------------------------------<br />
" ## ###<br />
"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-GJAHR&nbsp;=&nbsp;SY-DATUM(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUZEI&nbsp;=&nbsp;LV_BUZEI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SHKZG&nbsp;=&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_HKONT&nbsp;USING&nbsp;LV_KTOPL&nbsp;LV_KTOSL&nbsp;LV_BKLAS&nbsp;GS_HEADER_100-BUKRS&nbsp;GS_HEADER_100-LIFNR&nbsp;GS_BSEG-SHKZG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_KOART&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;CHANGING&nbsp;GS_BSEG-KOART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_BSCHL&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;GS_BSEG-SHKZG&nbsp;CHANGING&nbsp;GS_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SAKNR&nbsp;=&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SGTXT&nbsp;&nbsp;=&nbsp;|GR/IR-###&nbsp;:&nbsp;{&nbsp;LS_MAT-MAKTX&nbsp;}|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-WRBTR&nbsp;=&nbsp;&nbsp;LV_GRIR_FCY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-DMBTR&nbsp;=&nbsp;&nbsp;LV_GRIR_LCY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_BSEG&nbsp;TO&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_BUZEI&nbsp;=&nbsp;LV_BUZEI&nbsp;+&nbsp;1.<br />
"---------------------------------------------------------<br />
" #### PRD ## ##<br />
"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_KTOSL&nbsp;=&nbsp;'PRD'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LV_PRD_FCY&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_BSEG.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-GJAHR&nbsp;=&nbsp;SY-DATUM(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUZEI&nbsp;=&nbsp;LV_BUZEI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SHKZG&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;LV_PRD_FCY&nbsp;&lt;&nbsp;0&nbsp;THEN&nbsp;'S'&nbsp;ELSE&nbsp;'H'&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_HKONT&nbsp;USING&nbsp;LV_KTOPL&nbsp;LV_KTOSL&nbsp;LV_BKLAS&nbsp;GS_HEADER_100-BUKRS&nbsp;GS_HEADER_100-LIFNR&nbsp;GS_BSEG-SHKZG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_KOART&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;CHANGING&nbsp;GS_BSEG-KOART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_BSCHL&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;GS_BSEG-SHKZG&nbsp;CHANGING&nbsp;GS_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SAKNR&nbsp;=&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SGTXT&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-WRBTR&nbsp;=&nbsp;ABS(&nbsp;LV_PRD_FCY&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-DMBTR&nbsp;=&nbsp;ABS(&nbsp;LV_PRD_LCY&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_BSEG&nbsp;TO&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BUZEI&nbsp;=&nbsp;LV_BUZEI&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;KDM&nbsp;####<br />
&nbsp;&nbsp;&nbsp;&nbsp;"---------------------------------------------------------<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LV_KDM_LCY&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_KTOSL&nbsp;=&nbsp;'KDM'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-GJAHR&nbsp;=&nbsp;SY-DATUM(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUZEI&nbsp;=&nbsp;LV_BUZEI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SHKZG&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;LV_KDM_LCY&nbsp;&lt;&nbsp;0&nbsp;THEN&nbsp;'S'&nbsp;ELSE&nbsp;'H'&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_HKONT&nbsp;USING&nbsp;LV_KTOPL&nbsp;LV_KTOSL&nbsp;LV_BKLAS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_HEADER_100-BUKRS&nbsp;GS_HEADER_100-LIFNR&nbsp;GS_BSEG-SHKZG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_KOART&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;CHANGING&nbsp;GS_BSEG-KOART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_BSCHL&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;GS_BSEG-SHKZG&nbsp;CHANGING&nbsp;GS_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SAKNR&nbsp;=&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-DMBTR&nbsp;=&nbsp;ABS(&nbsp;LV_KDM_LCY&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-WRBTR&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SGTXT&nbsp;=&nbsp;COND&nbsp;#(&nbsp;WHEN&nbsp;LV_KDM_LCY&nbsp;&lt;&nbsp;0&nbsp;THEN&nbsp;'####'&nbsp;ELSE&nbsp;'####'&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_BSEG&nbsp;TO&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BUZEI&nbsp;=&nbsp;LV_BUZEI&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
"---------------------------------------------------------<br />
" #### Dr (##)<br />
"---------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_KTOSL&nbsp;=&nbsp;'BSX'.&nbsp;"<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-GJAHR&nbsp;=&nbsp;SY-DATUM(4).<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUZEI&nbsp;=&nbsp;LV_BUZEI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_HKONT&nbsp;USING&nbsp;LV_KTOPL&nbsp;LV_KTOSL&nbsp;LV_BKLAS&nbsp;GS_HEADER_100-BUKRS&nbsp;GS_HEADER_100-LIFNR&nbsp;GS_BSEG-SHKZG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_KOART&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;CHANGING&nbsp;GS_BSEG-KOART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_BSCHL&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;GS_BSEG-SHKZG&nbsp;CHANGING&nbsp;GS_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SAKNR&nbsp;=&nbsp;GS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SGTXT&nbsp;=&nbsp;'###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-WRBTR&nbsp;=&nbsp;LV_STD_FCY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-DMBTR&nbsp;=&nbsp;LV_STD_LCY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_BSEG&nbsp;TO&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_BUZEI&nbsp;=&nbsp;LV_BUZEI&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZMKPF01&nbsp;FROM&nbsp;GS_MKPF.<br />
&nbsp;&nbsp;INSERT&nbsp;ZMSEG01&nbsp;FROM&nbsp;TABLE&nbsp;GT_MSEG.<br />
&nbsp;&nbsp;INSERT&nbsp;ZBKPF01&nbsp;FROM&nbsp;GS_BKPF.<br />
&nbsp;&nbsp;INSERT&nbsp;ZBSEG01&nbsp;FROM&nbsp;TABLE&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;MESSAGE&nbsp;|&nbsp;####&nbsp;{&nbsp;GS_HEADER_100-MBLNR&nbsp;}#(#)&nbsp;######|&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CANCEL_GOODS_ITEMS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CANCEL_GOODS_ITEMS .<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_CHECK&nbsp;TYPE&nbsp;ABAP_BOOL&nbsp;VALUE&nbsp;ABAP_FALSE.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LT_SELECTED&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;TY_100,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;TY_100.<br />
&nbsp;&nbsp;DATA&nbsp;LV_ZEILE&nbsp;TYPE&nbsp;MSEG-ZEILE&nbsp;VALUE&nbsp;10.<br />
&nbsp;&nbsp;DATA&nbsp;LV_ANSWER&nbsp;TYPE&nbsp;C.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLEBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_QUESTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'######&nbsp;######?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'YES'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'NO'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY_CANCEL_BUTTON&nbsp;=&nbsp;'&nbsp;'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_ANSWER.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LV_ANSWER&nbsp;=&nbsp;'2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;NO&nbsp;###&nbsp;#<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'#######.'&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GT_DISP_100&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'#####&nbsp;####&nbsp;#######&nbsp;######'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;WITH&nbsp;KEY&nbsp;L_CHECK&nbsp;=&nbsp;'X'&nbsp;TRANSPORTING&nbsp;NO&nbsp;FIELDS.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'###&nbsp;###&nbsp;#####'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_MSEG&nbsp;,GS_MSEG,&nbsp;GT_MKPF&nbsp;,&nbsp;GS_MKPF.<br />
<br />
"-------------------------------------------------------------<br />
" ### ## ###<br />
"-------------------------------------------------------------<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISP_100&nbsp;INTO&nbsp;LS_ROW&nbsp;WHERE&nbsp;L_CHECK&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_ROW&nbsp;TO&nbsp;LT_SELECTED.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
"-------------------------------------------------------------<br />
" MKPF<br />
"-------------------------------------------------------------<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_MKPF.<br />
&nbsp;&nbsp;GS_MKPF-BLART&nbsp;=&nbsp;'WE'.<br />
&nbsp;&nbsp;GS_MKPF-BLDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_MKPF-BUDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_MKPF-MJAHR&nbsp;=&nbsp;SY-DATUM+0(4).<br />
&nbsp;&nbsp;GS_MKPF-STORN&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_MKPF-CRNAME&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;GS_MKPF-CRDATE&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_MKPF-CRZEIT&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_NEW_MBLNR&nbsp;CHANGING&nbsp;GS_MKPF-MBLNR.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;GS_MKPF&nbsp;TO&nbsp;GT_MKPF.<br />
<br />
"-------------------------------------------------------------<br />
" ### #### ## MSEG# ## (# ### ####)<br />
"-------------------------------------------------------------<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_SELECTED&nbsp;INTO&nbsp;LS_ROW.<br />
"-------------------------------------------------------------<br />
" ## MSEG ## ## SELECT<br />
"-------------------------------------------------------------<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_MSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MBLNR&nbsp;=&nbsp;GS_MKPF-MBLNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MJAHR&nbsp;=&nbsp;GS_MKPF-MJAHR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-LIFNR&nbsp;=&nbsp;LS_ROW-LIFNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-ZEILE&nbsp;=&nbsp;LV_ZEILE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-BUKRS&nbsp;=&nbsp;LS_ROW-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-EBELN&nbsp;=&nbsp;LS_ROW-EBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MATNR&nbsp;=&nbsp;LS_ROW-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-WERKS&nbsp;=&nbsp;LS_ROW-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-LGORT&nbsp;=&nbsp;LS_ROW-LGORT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-BWART&nbsp;=&nbsp;'102'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-SHKZG&nbsp;=&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MENGE&nbsp;=&nbsp;LS_ROW-GR_DONE_QTY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-DMBTR&nbsp;=&nbsp;LS_ROW-DMBTR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-WAERS&nbsp;=&nbsp;LS_ROW-WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-MEINS&nbsp;=&nbsp;LS_ROW-MEINS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-STBLG&nbsp;=&nbsp;LS_ROW-MBLNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-STJAH&nbsp;=&nbsp;LS_ROW-MJAHR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MSEG-STORN&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_ZEILE&nbsp;=&nbsp;LV_ZEILE&nbsp;+&nbsp;10.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_MSEG&nbsp;TO&nbsp;GT_MSEG.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"-------------------------------------------------------------<br />
&nbsp;&nbsp;"&nbsp;DB&nbsp;##<br />
&nbsp;&nbsp;"-------------------------------------------------------------<br />
&nbsp;&nbsp;INSERT&nbsp;ZMKPF01&nbsp;FROM&nbsp;TABLE&nbsp;GT_MKPF.<br />
&nbsp;&nbsp;INSERT&nbsp;ZMSEG01&nbsp;FROM&nbsp;TABLE&nbsp;GT_MSEG.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CANCEL_FI_DOCUMENT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CANCEL_FI_DOCUMENT .<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_BKPF&nbsp;TYPE&nbsp;ZBKPF01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_BSEG&nbsp;TYPE&nbsp;ZBSEG01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_BSEG&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;LS_BSEG,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TEMP_BSEG&nbsp;TYPE&nbsp;ZBSEG01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_TEMP_BSEG&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;LS_BSEG.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_BUZEI&nbsp;TYPE&nbsp;ZBSEG01-BUZEI&nbsp;VALUE&nbsp;1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BELNR&nbsp;TYPE&nbsp;ZBSEG01-BELNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_PRICE_SUM&nbsp;&nbsp;TYPE&nbsp;ZBSEG01-DMBTR.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_KTOPL&nbsp;TYPE&nbsp;ZSKA1_01-KTOPL&nbsp;VALUE&nbsp;'ZCOA',<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_KTOSL&nbsp;TYPE&nbsp;ZSKA1_01-KTOSL,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_BKLAS&nbsp;TYPE&nbsp;ZSKA1_01-BKLAS&nbsp;VALUE&nbsp;'3000'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_BKPF&nbsp;,&nbsp;GS_BKPF&nbsp;,&nbsp;GT_BSEG&nbsp;,&nbsp;GS_BSEG.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;####&nbsp;##&nbsp;4800000000~&nbsp;(05)<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_NEW_BELNR&nbsp;USING&nbsp;C_NR_FI_GR_CANC&nbsp;CHANGING&nbsp;LV_BELNR&nbsp;.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##&nbsp;##&nbsp;(&nbsp;#####&nbsp;)<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZBKPF01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;LS_BKPF<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;XBLNR&nbsp;=&nbsp;GS_MSEG-STBLG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUKRS&nbsp;=&nbsp;GS_HEADER_100-BUKRS.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MSEG&nbsp;INTO&nbsp;GS_MSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;LT_TEMP_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZBSEG01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_TEMP_BSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;BELNR&nbsp;=&nbsp;LS_BKPF-BELNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;&nbsp;MATNR&nbsp;=&nbsp;GS_MSEG-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_TEMP_BSEG&nbsp;INTO&nbsp;LS_TEMP_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TEMP_BSEG&nbsp;TO&nbsp;LT_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##&nbsp;&nbsp;###<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_BKPF-BUKRS&nbsp;=&nbsp;LS_BKPF-BUKRS.<br />
&nbsp;&nbsp;GS_BKPF-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;GS_BKPF-GJAHR&nbsp;=&nbsp;LS_BKPF-GJAHR.<br />
&nbsp;&nbsp;GS_BKPF-BLART&nbsp;=&nbsp;'WE'.<br />
&nbsp;&nbsp;GS_BKPF-BLDAT&nbsp;=&nbsp;LS_BKPF-BLDAT.<br />
&nbsp;&nbsp;GS_BKPF-BUDAT&nbsp;=&nbsp;LS_BKPF-BUDAT.<br />
&nbsp;&nbsp;GS_BKPF-KURSF&nbsp;=&nbsp;LS_BKPF-KURSF.<br />
&nbsp;&nbsp;GS_BKPF-WAERS&nbsp;=&nbsp;LS_BKPF-WAERS.<br />
&nbsp;&nbsp;GS_BKPF-TCODE&nbsp;=&nbsp;'MIGO'.<br />
&nbsp;&nbsp;GS_BKPF-XBLNR&nbsp;=&nbsp;GS_MKPF-MBLNR.<br />
&nbsp;&nbsp;GS_BKPF-XSTOV&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_BKPF-CPUDT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;GS_BKPF-CPUTM&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;GS_BKPF-CRNAME&nbsp;=&nbsp;SY-UNAME.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;##&nbsp;##&nbsp;###<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_BSEG&nbsp;INTO&nbsp;LS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUKRS&nbsp;=&nbsp;LS_BSEG-BUKRS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BELNR&nbsp;=&nbsp;LV_BELNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-GJAHR&nbsp;=&nbsp;LS_BSEG-GJAHR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-BUZEI&nbsp;=&nbsp;LV_BUZEI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_BSEG-SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SHKZG&nbsp;=&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-MATNR&nbsp;=&nbsp;LS_BSEG-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-HKONT&nbsp;=&nbsp;LS_BSEG-HKONT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-KOART&nbsp;=&nbsp;LS_BSEG-KOART.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_BSCHL&nbsp;USING&nbsp;GS_BSEG-HKONT&nbsp;GS_BSEG-SHKZG&nbsp;CHANGING&nbsp;GS_BSEG-BSCHL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SAKNR&nbsp;=&nbsp;LS_BSEG-SAKNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-SGTXT&nbsp;&nbsp;=&nbsp;|####&nbsp;:&nbsp;{&nbsp;LS_BSEG-SGTXT&nbsp;}|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-WRBTR&nbsp;=&nbsp;ABS(&nbsp;LS_BSEG-WRBTR&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_BSEG-DMBTR&nbsp;=&nbsp;ABS(&nbsp;LS_BSEG-DMBTR&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_BSEG&nbsp;TO&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_BUZEI&nbsp;=&nbsp;LV_BUZEI&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZBKPF01&nbsp;FROM&nbsp;GS_BKPF.<br />
&nbsp;&nbsp;INSERT&nbsp;ZBSEG01&nbsp;FROM&nbsp;TABLE&nbsp;GT_BSEG.<br />
&nbsp;&nbsp;MESSAGE&nbsp;|&nbsp;####&nbsp;{&nbsp;GS_MKPF-MBLNR&nbsp;}#(#)&nbsp;######|&nbsp;TYPE&nbsp;'S'.<br />
&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;SET_ITEM_OK_TO_GREEN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ITEM_OK_TO_GREEN .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_ROW&nbsp;TYPE&nbsp;TY_100.<br />
&nbsp;&nbsp;IF&nbsp;GS_DISP_100-L_CHECK&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;INDEX&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;LS_ROW&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ROW-COLOR&nbsp;=&nbsp;ICON_GREEN_LIGHT.&nbsp;&nbsp;&nbsp;"&nbsp;#&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ROW-L_CHECK&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISP_100&nbsp;FROM&nbsp;LS_ROW&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;INDEX&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;LS_ROW&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ROW-COLOR&nbsp;=&nbsp;ICON_YELLOW_LIGHT.&nbsp;&nbsp;&nbsp;"&nbsp;#&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ROW-L_CHECK&nbsp;=&nbsp;'&nbsp;'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISP_100&nbsp;FROM&nbsp;LS_ROW&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;UPDATE_SCREEN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM UPDATE_SCREEN .<br />
&nbsp;&nbsp;GS_DISP_100-DMBTR&nbsp;=&nbsp;GS_DISP_100-GR_QTY&nbsp;*&nbsp;GS_DISP_100-NETPR.<br />
&nbsp;&nbsp;MODIFY&nbsp;GT_DISP_100&nbsp;FROM&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;SORT_LINE_UP<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SORT_LINE_UP .<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISP_100&nbsp;BY&nbsp;EBELP&nbsp;ASCENDING.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;SORT_LINE_DOWN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SORT_LINE_DOWN .<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISP_100&nbsp;BY&nbsp;EBELP&nbsp;DESCENDING.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CREATE_OBJECT_DISP<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_DISP .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GC_CUSTOM<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'CON1'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LIFETIME_DEFAULT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REPID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_AUTODEF_PROGID_DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_SYSTEM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATE_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME_DYNPRO_DYNPRO_LINK&nbsp;=&nbsp;5<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GC_CUSTOM2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'CON2'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LIFETIME_DEFAULT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REPID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_AUTODEF_PROGID_DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_SYSTEM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATE_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME_DYNPRO_DYNPRO_LINK&nbsp;=&nbsp;5<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_TREE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GC_CUSTOM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NODE_SELECTION_MODE&nbsp;&nbsp;&nbsp;=&nbsp;CL_GUI_COLUMN_TREE=&gt;NODE_SEL_MODE_SINGLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITEM_SELECTION&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HIERARCHY_COLUMN_NAME&nbsp;=&nbsp;GV_HCOL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HIERARCHY_HEADER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_HEADER<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LIFETIME_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CNTL_SYSTEM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CREATE_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILLEGAL_NODE_SELECTION_MODE&nbsp;=&nbsp;4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FAILED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ILLEGAL_COLUMN_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GC_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SHELLSTYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_LIFETIME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GC_CUSTOM2.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_APPL_EVENTS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SPACE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENTDBG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_APPLOGPARENT&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_GRAPHICSPARENT&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_FCAT_COMPLETE&nbsp;&nbsp;&nbsp;=&nbsp;SPACE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_CNTL_CREATE&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_CNTL_INIT&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_CNTL_LINK&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR_DP_CREATE&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ALV_DISPLAY_DISP<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ALV_DISPLAY_DISP  USING  PT_ALV_DATA.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'A'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PT_ALV_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;=&nbsp;GT_FIELDCAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_SORT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;IMPLEMENT&nbsp;SUITABLE&nbsp;ERROR&nbsp;HANDLING&nbsp;HERE<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;REGISTER_EDIT_EVENT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;FILL_NODE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM FILL_NODE .<br />
&nbsp;&nbsp;CLEAR:&nbsp;GT_NODES,&nbsp;GT_ITEMS.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_NODE&nbsp;TYPE&nbsp;TREEV_NODE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ITEM&nbsp;TYPE&nbsp;MTREEITM.<br />
<br />
&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;"&nbsp;1)&nbsp;PURCHASE&nbsp;ORDERS&nbsp;(###&nbsp;##)<br />
&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_NODE.<br />
&nbsp;&nbsp;LS_NODE-NODE_KEY&nbsp;&nbsp;=&nbsp;'PO_ROOT'.<br />
&nbsp;&nbsp;LS_NODE-ISFOLDER&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;LS_NODE-N_IMAGE&nbsp;&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;LS_NODE-EXP_IMAGE&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_NODE&nbsp;TO&nbsp;GT_NODES.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_ITEM.<br />
&nbsp;&nbsp;LS_ITEM-NODE_KEY&nbsp;&nbsp;=&nbsp;'PO_ROOT'.<br />
&nbsp;&nbsp;LS_ITEM-ITEM_NAME&nbsp;=&nbsp;GV_HCOL.<br />
&nbsp;&nbsp;LS_ITEM-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_ITEM&nbsp;TO&nbsp;GT_ITEMS.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;PURCHASE&nbsp;ORDER&nbsp;##&nbsp;##<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;ADD_DOC&nbsp;USING&nbsp;'PO_ROOT'&nbsp;P_EBELN.<br />
<br />
&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;"&nbsp;2)&nbsp;MATERIAL&nbsp;DOCUMENTS<br />
&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_NODE.<br />
&nbsp;&nbsp;LS_NODE-NODE_KEY&nbsp;&nbsp;=&nbsp;'MM_ROOT'.<br />
&nbsp;&nbsp;LS_NODE-ISFOLDER&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;LS_NODE-N_IMAGE&nbsp;&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;LS_NODE-EXP_IMAGE&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_NODE&nbsp;TO&nbsp;GT_NODES.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_ITEM.<br />
&nbsp;&nbsp;LS_ITEM-NODE_KEY&nbsp;&nbsp;=&nbsp;'MM_ROOT'.<br />
&nbsp;&nbsp;LS_ITEM-ITEM_NAME&nbsp;=&nbsp;GV_HCOL.<br />
&nbsp;&nbsp;LS_ITEM-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_ITEM&nbsp;TO&nbsp;GT_ITEMS.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;MATERIAL&nbsp;DOCUMENTS<br />
&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MKPF&nbsp;INTO&nbsp;GS_MKPF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_MKPF-STORN&nbsp;=&nbsp;'&nbsp;'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ADD_DOC&nbsp;USING&nbsp;'MM_ROOT'&nbsp;GS_MKPF-MBLNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;"&nbsp;2)&nbsp;MATERIAL&nbsp;DOCUMENTS<br />
&nbsp;&nbsp;"---------------------------------------------------------<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_NODE.<br />
&nbsp;&nbsp;LS_NODE-NODE_KEY&nbsp;&nbsp;=&nbsp;'MM_ROOT2'.<br />
&nbsp;&nbsp;LS_NODE-ISFOLDER&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;LS_NODE-N_IMAGE&nbsp;&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;LS_NODE-EXP_IMAGE&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_NODE&nbsp;TO&nbsp;GT_NODES.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_ITEM.<br />
&nbsp;&nbsp;LS_ITEM-NODE_KEY&nbsp;&nbsp;=&nbsp;'MM_ROOT2'.<br />
&nbsp;&nbsp;LS_ITEM-ITEM_NAME&nbsp;=&nbsp;GV_HCOL.<br />
&nbsp;&nbsp;LS_ITEM-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_ITEM&nbsp;TO&nbsp;GT_ITEMS.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;MATERIAL&nbsp;DOCUMENTS<br />
&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MKPF&nbsp;INTO&nbsp;GS_MKPF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_MKPF-STORN&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ADD_DOC&nbsp;USING&nbsp;'MM_ROOT2'&nbsp;GS_MKPF-MBLNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;GO_TREE-&gt;ADD_NODES_AND_ITEMS(<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NODE_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_NODES<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITEM_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_ITEMS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ITEM_TABLE_STRUCTURE_NAME&nbsp;=&nbsp;'MTREEITM'<br />
&nbsp;&nbsp;).<br />
<br />
<br />
&nbsp;&nbsp;GO_TREE-&gt;EXPAND_ROOT_NODES(&nbsp;LEVEL_COUNT&nbsp;=&nbsp;1&nbsp;).<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;ADD_DOC<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ADD_DOC USING PV_PARENT PV_DOC.<br />
&nbsp;&nbsp;DATA:&nbsp;LS_NODE&nbsp;TYPE&nbsp;TREEV_NODE,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_ITEM&nbsp;TYPE&nbsp;MTREEITM.<br />
<br />
&nbsp;&nbsp;"##&nbsp;##&nbsp;(##)<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_NODE.<br />
&nbsp;&nbsp;LS_NODE-NODE_KEY&nbsp;&nbsp;=&nbsp;PV_DOC.<br />
&nbsp;&nbsp;LS_NODE-RELATKEY&nbsp;&nbsp;=&nbsp;PV_PARENT.<br />
&nbsp;&nbsp;LS_NODE-RELATSHIP&nbsp;=&nbsp;CL_GUI_COLUMN_TREE=&gt;RELAT_LAST_CHILD.<br />
&nbsp;&nbsp;LS_NODE-ISFOLDER&nbsp;&nbsp;=&nbsp;''.&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;LS_NODE-N_IMAGE&nbsp;&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;LS_NODE-EXP_IMAGE&nbsp;=&nbsp;C_ICON_NONE.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_NODE&nbsp;TO&nbsp;GT_NODES.<br />
<br />
&nbsp;&nbsp;"###&nbsp;##&nbsp;(##&nbsp;##&nbsp;##)<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_ITEM.<br />
&nbsp;&nbsp;LS_ITEM-NODE_KEY&nbsp;&nbsp;=&nbsp;PV_DOC.<br />
&nbsp;&nbsp;LS_ITEM-ITEM_NAME&nbsp;=&nbsp;GV_HCOL.<br />
&nbsp;&nbsp;LS_ITEM-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PV_DOC.<br />
&nbsp;&nbsp;APPEND&nbsp;LS_ITEM&nbsp;TO&nbsp;GT_ITEMS.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;CLASS_EVENT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CLASS_EVENT_0100 .<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_EVENT.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_TOOLBAR&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_USER_COMMAND&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_HOTSPOT_CLICK&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_DOUBLE_CLICK&nbsp;FOR&nbsp;GC_GRID.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GC_GRID-&gt;REGISTER_EDIT_EVENT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
   </div>
   <div class="code">
&nbsp;&nbsp;.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_BUTTON_CLICK&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_DATA_CHANGED&nbsp;FOR&nbsp;GC_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_EVENT-&gt;HANDLER_DATA_CHANGED_FINISHED&nbsp;FOR&nbsp;GC_GRID.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LT_EVENTS&nbsp;TYPE&nbsp;CNTL_SIMPLE_EVENTS.<br />
&nbsp;&nbsp;LT_EVENTS&nbsp;=&nbsp;VALUE&nbsp;#(<br />
&nbsp;&nbsp;(&nbsp;EVENTID&nbsp;=&nbsp;CL_GUI_COLUMN_TREE=&gt;EVENTID_NODE_DOUBLE_CLICK&nbsp;APPL_EVENT&nbsp;=&nbsp;'X'&nbsp;)<br />
&nbsp;&nbsp;(&nbsp;EVENTID&nbsp;=&nbsp;CL_GUI_COLUMN_TREE=&gt;EVENTID_ITEM_DOUBLE_CLICK&nbsp;APPL_EVENT&nbsp;=&nbsp;'X'&nbsp;)<br />
&nbsp;&nbsp;).<br />
<br />
&nbsp;&nbsp;GO_TREE-&gt;SET_REGISTERED_EVENTS(&nbsp;EXPORTING&nbsp;EVENTS&nbsp;=&nbsp;LT_EVENTS&nbsp;).<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_TREE_EVENT.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;GO_TREE_EVENT-&gt;ON_ITEM_DOUBLE_CLICK&nbsp;FOR&nbsp;GO_TREE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;TREE_HANDLER_ITEM_DOUBLE_CLICK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM TREE_HANDLER_ITEM_DOUBLE_CLICK  USING    P_NODE_KEY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_ITEM_NAME.<br />
&nbsp;&nbsp;DATA:&nbsp;LT_MSEG&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZMSEG01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_MSEG&nbsp;TYPE&nbsp;ZMSEG01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_MKPF&nbsp;TYPE&nbsp;ZMKPF01,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_MAKTX&nbsp;TYPE&nbsp;ZMAT01-MAKTX.<br />
&nbsp;&nbsp;DATA:&nbsp;LS_EKPO&nbsp;TYPE&nbsp;ZEKPO01.<br />
&nbsp;&nbsp;DATA:&nbsp;LV_CANCELED&nbsp;TYPE&nbsp;ABAP_BOOL&nbsp;VALUE&nbsp;ABAP_TRUE.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_KURSF&nbsp;TYPE&nbsp;ZBKPF01-KURSF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;P_NODE_KEY&nbsp;=&nbsp;P_EBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMSEG01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_MSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MBLNR&nbsp;=&nbsp;P_NODE_KEY.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMKPF01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;LS_MKPF<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MBLNR&nbsp;=&nbsp;P_NODE_KEY.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;KURSF<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZBKPF01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_KURSF<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;XBLNR&nbsp;=&nbsp;P_NODE_KEY.<br />
<br />
&nbsp;&nbsp;GS_HEADER_100-WERKS&nbsp;=&nbsp;P_WERKS.<br />
&nbsp;&nbsp;GS_HEADER_100-BLDAT&nbsp;=&nbsp;LS_MKPF-BLDAT.<br />
&nbsp;&nbsp;GS_HEADER_100-BUDAT&nbsp;=&nbsp;LS_MKPF-BUDAT.<br />
&nbsp;&nbsp;GS_HEADER_100-INCO1&nbsp;=&nbsp;GS_EKKO-INCO1.<br />
&nbsp;&nbsp;GS_HEADER_100-BWART&nbsp;=&nbsp;102.<br />
&nbsp;&nbsp;GS_HEADER_100-MODE_TX&nbsp;=&nbsp;'####&nbsp;#&nbsp;##'.<br />
&nbsp;&nbsp;GS_HEADER_100-KURSF&nbsp;=&nbsp;LV_KURSF.<br />
&nbsp;&nbsp;GS_HEADER_100-MBLNR&nbsp;&nbsp;=&nbsp;LS_MKPF-MBLNR.<br />
&nbsp;&nbsp;GS_HEADER_100-CRNAME&nbsp;=&nbsp;LS_MKPF-CRNAME.<br />
&nbsp;&nbsp;GS_HEADER_100-CRDATE&nbsp;=&nbsp;LS_MKPF-CRDATE.<br />
&nbsp;&nbsp;GS_HEADER_100-CRZEIT&nbsp;=&nbsp;LS_MKPF-CRZEIT.<br />
&nbsp;&nbsp;GS_HEADER_100-TCODE&nbsp;=&nbsp;'MIGO'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LS_MKPF&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'##&nbsp;#####&nbsp;###&nbsp;####&nbsp;####.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_DISP_100.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_MSEG&nbsp;INTO&nbsp;LS_MSEG.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_DISP_100&nbsp;,&nbsp;LS_EKPO&nbsp;,&nbsp;LV_MAKTX.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1)&nbsp;###,&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MAKTX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_MAKTX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMAT01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LS_MSEG-MATNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MWSKZ&nbsp;PRDAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;LS_EKPO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKPO01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LS_MSEG-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EBELN&nbsp;=&nbsp;P_EBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2)&nbsp;##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;LS_MSEG&nbsp;TO&nbsp;GS_DISP_100.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-MAKTX&nbsp;=&nbsp;LV_MAKTX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-MWSKZ&nbsp;=&nbsp;LS_EKPO-MWSKZ.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-PRDAT&nbsp;=&nbsp;LS_EKPO-PRDAT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-GR_DONE_QTY&nbsp;=&nbsp;LS_MSEG-MENGE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;NETPR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_DISP_100-NETPR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKPO01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LS_MSEG-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EBELN&nbsp;=&nbsp;P_EBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MENGE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_DISP_100-MENGE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKPO01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LS_MSEG-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EBELN&nbsp;=&nbsp;P_EBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MEINS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_DISP_100-MEINS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEKPO01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;LS_MSEG-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;EBELN&nbsp;=&nbsp;P_EBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_WERKS_TEXT&nbsp;USING&nbsp;GS_DISP_100-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_DISP_100-WERKS_TX.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_LGORT_TEXT&nbsp;USING&nbsp;GS_DISP_100-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-LGORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GS_DISP_100-LGORT_TX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;3)&nbsp;#####&nbsp;##&nbsp;###&nbsp;##&nbsp;######&nbsp;###<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_CANCELED&nbsp;=&nbsp;ABAP_FALSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MBLNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMSEG01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;@DATA(LV_DUMMY)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;BWART&nbsp;=&nbsp;'102'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;STBLG&nbsp;=&nbsp;@LS_MSEG-MBLNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;STJAH&nbsp;=&nbsp;@LS_MSEG-MJAHR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;=&nbsp;@LS_MSEG-MATNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_CANCELED&nbsp;=&nbsp;ABAP_TRUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LV_CANCELED&nbsp;=&nbsp;ABAP_TRUE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-REMARK&nbsp;&nbsp;=&nbsp;'##&nbsp;###'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-NO_EDIT&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;4)&nbsp;####&nbsp;##&nbsp;##&nbsp;(BWART&nbsp;=&nbsp;102)<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;LS_MSEG-BWART&nbsp;=&nbsp;'102'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-REMARK&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-NO_EDIT&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;5)&nbsp;##&nbsp;####&nbsp;##&nbsp;##&nbsp;####&nbsp;DISABLE&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;"-------------------------------------------------------<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISP_100-NO_EDIT&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA(LS_STYLE)&nbsp;=&nbsp;VALUE&nbsp;LVC_S_STYL(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELDNAME&nbsp;=&nbsp;'L_CHECK'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_DISABLED&nbsp;).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;LS_STYLE&nbsp;INTO&nbsp;TABLE&nbsp;GS_DISP_100-CELLTAB.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISP_100-REMARK&nbsp;&nbsp;=&nbsp;'####'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISP_100&nbsp;TO&nbsp;GT_DISP_100.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISP_100&nbsp;INTO&nbsp;GS_DISP_100&nbsp;INDEX&nbsp;GV_CURR_INDEX.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;DELETE_ALV_ITEMS<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DELETE_ALV_ITEMS .<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GT_DISP_100.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;EXCLUDE_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;p1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;p2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM EXCLUDE_TOOLBAR .<br />
&nbsp;&nbsp;GS_EXCLUDE&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_INSERT_ROW.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_EXCLUDE&nbsp;TO&nbsp;GT_EXCLUDE.<br />
<br />
&nbsp;&nbsp;GS_EXCLUDE&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_DELETE_ROW.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_EXCLUDE&nbsp;TO&nbsp;GT_EXCLUDE.<br />
<br />
&nbsp;&nbsp;GS_EXCLUDE&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_APPEND_ROW.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_EXCLUDE&nbsp;TO&nbsp;GT_EXCLUDE.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_GR_QTY<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_GR_QTY  USING    P_EBELN P_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_DONE_QTY.<br />
&nbsp;&nbsp;CLEAR&nbsp;P_DONE_QTY.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_GR101&nbsp;TYPE&nbsp;MENGE_D,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_GR102&nbsp;TYPE&nbsp;MENGE_D.<br />
<br />
&nbsp;&nbsp;"&nbsp;101&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;SELECT&nbsp;SUM(&nbsp;MENGE&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_GR101<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMSEG01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;P_EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;=&nbsp;P_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BWART&nbsp;=&nbsp;'101'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LV_GR101.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;102&nbsp;####&nbsp;##<br />
&nbsp;&nbsp;SELECT&nbsp;SUM(&nbsp;MENGE&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_GR102<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMSEG01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;EBELN&nbsp;=&nbsp;P_EBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;=&nbsp;P_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BWART&nbsp;=&nbsp;'102'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LV_GR102.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;##&nbsp;####<br />
&nbsp;&nbsp;P_DONE_QTY&nbsp;=&nbsp;LV_GR101&nbsp;-&nbsp;LV_GR102.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_HKONT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_HKONT USING    P_KTOPL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_KTOSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BKLAS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BUKRS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_LIFNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_SHKZG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_HKONT.<br />
<br />
&nbsp;&nbsp;"-----------------------------------------------------<br />
&nbsp;&nbsp;"&nbsp;#####&nbsp;(KBS)<br />
&nbsp;&nbsp;"-----------------------------------------------------<br />
&nbsp;&nbsp;IF&nbsp;P_KTOSL&nbsp;=&nbsp;'KBS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;AKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_HKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;LFB1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;LIFNR&nbsp;=&nbsp;P_LIFNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BUKRS&nbsp;=&nbsp;P_BUKRS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;P_KTOSL&nbsp;=&nbsp;'KDM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;SAKNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_HKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZSKA1_01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KTOPL&nbsp;=&nbsp;P_KTOPL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KTOSL&nbsp;=&nbsp;P_KTOSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BKLAS&nbsp;=&nbsp;P_BKLAS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KTOKS&nbsp;=&nbsp;'REV1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;SAKNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_HKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZSKA1_01<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;KTOPL&nbsp;=&nbsp;P_KTOPL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KTOSL&nbsp;=&nbsp;P_KTOSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BKLAS&nbsp;=&nbsp;P_BKLAS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KTOKS&nbsp;=&nbsp;'EXP1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;RETURN.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;"-----------------------------------------------------<br />
&nbsp;&nbsp;"&nbsp;WRX,&nbsp;PRD,&nbsp;BSX,&nbsp;MWS&nbsp;#&nbsp;#&nbsp;ZSKA1_01&nbsp;#####&nbsp;##<br />
&nbsp;&nbsp;"-----------------------------------------------------<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;SAKNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_HKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZSKA1_01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;KTOPL&nbsp;=&nbsp;P_KTOPL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;KTOSL&nbsp;=&nbsp;P_KTOSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;BKLAS&nbsp;=&nbsp;P_BKLAS.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_BSCHL<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_BSCHL  USING    P_HKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_SHKZG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_BSCHL.<br />
DATA : P_KTOSL TYPE ZSKA1_01-KTOSL.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;KTOSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZSKA1_01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_KTOSL<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAKNR&nbsp;=&nbsp;P_HKONT.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;P_KTOSL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WRX'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"GR/IR&nbsp;Clearing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'96'.&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'86'.&nbsp;&nbsp;&nbsp;"##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BSX'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'50'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PRD'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"####<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'50'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MWS'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"###<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'50'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MWS'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Vender<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'21'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'31'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;P_SHKZG&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'40'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_BSCHL&nbsp;=&nbsp;'50'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_KOART<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;text<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_KOART  USING    P_HKONT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_KOART.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;KOART<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZSKA1_01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_KOART<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAKNR&nbsp;=&nbsp;P_HKONT.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_WERKS_TEXT<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_WERKS_TEXT  USING    P_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_WERKS_TX.<br />
&nbsp;&nbsp;CLEAR&nbsp;P_WERKS_TX.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_WERKS_TX<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZTWERKS01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;=&nbsp;P_WERKS.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;P_WERKS_TX&nbsp;=&nbsp;'##&nbsp;###'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_LGORT_TEXT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_LGORT_TEXT  USING    P_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_LGORT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_LGORT_TX.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;P_LGORT_TX.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_LGORT_TX<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZTLGORT01<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;=&nbsp;P_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LGORT&nbsp;=&nbsp;P_LGORT.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;P_LGORT_TX&nbsp;=&nbsp;'##&nbsp;####'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_NEW_BELNR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_NEW_BELNR  USING P_NR CHANGING P_BELNR.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZBELNR01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;=&nbsp;P_NR<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;P_BELNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_NEW_MBLNR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_NEW_MBLNR  CHANGING PS_MKPF_MBLNR.<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZMBELN01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;=&nbsp;'01'<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;PS_MKPF_MBLNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
ENDFORM.<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_NEXT_ITEM<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_NEXT_ITEM .<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_CURR_INDEX&nbsp;=&nbsp;GV_CURR_INDEX&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GV_CURR_INDEX&nbsp;&gt;&nbsp;LINES(&nbsp;GT_EKPO&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_CURR_INDEX&nbsp;=&nbsp;LINES(&nbsp;GT_EKPO&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DISPLAY_DATA.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FORM&nbsp;&nbsp;GET_PERV_ITEM<br />
*&---------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
*&nbsp;&nbsp;--&gt;&nbsp;&nbsp;P1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*&nbsp;&nbsp;&lt;--&nbsp;&nbsp;P2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT<br />
*----------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_PERV_ITEM .<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_CURR_INDEX&nbsp;=&nbsp;GV_CURR_INDEX&nbsp;-&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GV_CURR_INDEX&nbsp;&lt;&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_CURR_INDEX&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_DISPLAY_DATA.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_ITEM_PRICE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_ITEM_PRICE  USING    P_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_PRICE.<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LS_MAT&nbsp;TYPE&nbsp;ZMAT01.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*&nbsp;FROM&nbsp;ZMAT01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;LS_MAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;P_MATNR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LS_MAT-VPRSV&nbsp;=&nbsp;'S'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;P_PRICE&nbsp;=&nbsp;LS_MAT-STPRS.<br />
&nbsp;&nbsp;ELSEIF&nbsp;LS_MAT-VPRSV&nbsp;=&nbsp;'V'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;P_PRICE&nbsp;=&nbsp;LS_MAT-VERPR.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_FI_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FI_DATA .<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GS_BKPF&nbsp;,&nbsp;GT_BSEG&nbsp;,&nbsp;GS_FI_ALV&nbsp;,&nbsp;GT_FI_ALV&nbsp;,&nbsp;GT_FI_SUM&nbsp;,&nbsp;GS_FI_SUM.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZBKPF01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_BKPF<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;XBLNR&nbsp;=&nbsp;GS_HEADER_100-MBLNR.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZBSEG01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_BSEG<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;BELNR&nbsp;=&nbsp;GS_BKPF-BELNR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GS_BKPF&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'##&nbsp;####&nbsp;##&nbsp;##&nbsp;####.'&nbsp;TYPE&nbsp;'S'&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;GV_PERIOD&nbsp;=&nbsp;GS_BKPF-BUDAT+4(2).<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_BSEG&nbsp;INTO&nbsp;GS_BSEG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_BSEG&nbsp;TO&nbsp;GS_FI_ALV.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_FI_ALV-WAERS&nbsp;=&nbsp;GS_BKPF-WAERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_FI_ALV&nbsp;TO&nbsp;GT_FI_ALV.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;MODIFY_FI_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_FI_DATA .<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_BUZEI&nbsp;TYPE&nbsp;ZBSEG01-BUZEI&nbsp;VALUE&nbsp;1.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FI_ALV&nbsp;INTO&nbsp;GS_FI_ALV.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_FI_ALV-WAERS_D&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_FI_ALV-SHKZG&nbsp;=&nbsp;'H'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FI_ALV-DMBTR&nbsp;=&nbsp;-&nbsp;GS_FI_ALV-DMBTR&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FI_ALV-WRBTR&nbsp;=&nbsp;-&nbsp;GS_FI_ALV-WRBTR&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_FI_SUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_FI_ALV&nbsp;TO&nbsp;GS_FI_SUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"##&nbsp;##&nbsp;##<br />
&nbsp;&nbsp;&nbsp;&nbsp;COLLECT&nbsp;GS_FI_SUM&nbsp;INTO&nbsp;GT_FI_SUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FI_ALV&nbsp;FROM&nbsp;GS_FI_ALV.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GT_FI_ALV.<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FI_SUM&nbsp;INTO&nbsp;GS_FI_SUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_FI_SUM&nbsp;TO&nbsp;GS_FI_ALV.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_FI_ALV-BUZEI&nbsp;=&nbsp;LV_BUZEI.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_BUZEI&nbsp;=&nbsp;LV_BUZEI&nbsp;+&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_FI_ALV&nbsp;TO&nbsp;GT_FI_ALV.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;GET_MATKL<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_MATKL  USING    P_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;P_MATKL.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;MATKL<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZMAT01<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;P_MATKL<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;P_MATNR.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Form&nbsp;&nbsp;CHECK_MANDOTORY<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_MANDOTORY .<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;GV_CHECK_FLAG.<br />
&nbsp;&nbsp;GV_CHECK_FLAG&nbsp;=&nbsp;ABAP_TRUE.<br />
<br />
&nbsp;&nbsp;IF&nbsp;GS_HEADER_100-WAERS&nbsp;&lt;&gt;&nbsp;C_WAERS_D.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_HEADER_100-KURSF&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_CHECK_FLAG&nbsp;=&nbsp;ABAP_FALSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.5 - E.G.Mellodew. 1998-2025. Sap Release 750</td>
   </tr>
</table>
</body>
</html>
