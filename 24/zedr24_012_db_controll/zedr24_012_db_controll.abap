
*&---------------------------------------------------------------------*

*& Report ZEDR24_012_DB_CONTROLL

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR24_012_DB_CONTROLL.



"-----------------------------------------------------

"1. SELECT ## 1#




*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.



*SELECT SINGLE CARRID CARRNAME

*  INTO ( GS_SCARR-CARRID, GS_SCARR-CARRNAME )

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.






"-----------------------------------------------------

"2. SELECT ## N#




*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.



*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"3. SELECT ## N# + ### ### ##




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"4. SELECT + APPENDING




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AB'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"5. WHERE - BETWEEN




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID BETWEEN 'AA' AND 'AB'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"6. WHERE - STRING




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID LIKE 'a'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"7. WHERE - LIST




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN ( 'AA', 'AC' ).

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"8. WHERE - RANGE TABLE




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*RANGES GR_SCARR FOR SCARR-CARRID.

*CLEAR GR_SCARR.

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'CP'.

*GR_SCARR-LOW = '*A'.

*APPEND GR_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"8-1. WHERE - RANGE TABLE




*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*RANGES GR_SCARR FOR SCARR-CARRID.

*CLEAR GR_SCARR.

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'EQ'.

*GR_SCARR-LOW = 'AA'.

*APPEND GR_SCARR.

*

*GR_SCARR-LOW = 'AB'.

*APPEND GR_SCARR.

*

*SELECT CARRID CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.






"-----------------------------------------------------

"9. GROUPING - AVG




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID CONNID

*  AVG( PRICE ) AS GV_SUM "CARRID# CONNID# ## PRICE# ## (CARRID, CONNID# ## ## #### ##)

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.






"-----------------------------------------------------

"10. GROUPING - HAVING




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID CONNID

*  AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.






"-----------------------------------------------------

"11. GROUPING - ORDERED BY




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_SUM TYPE I,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID CONNID

*  AVG( PRICE ) AS GV_SUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY CARRID.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_SUM.

*ENDLOOP.






"-----------------------------------------------------

"12. SUB QUERY - SELECT




*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID

*       CONNID

*       PRICE

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT

*  WHERE CARRID IN ( SELECT CARRID

*                      FROM SPFLI

*                      WHERE CARRID = SFLIGHT~CARRID

*                        AND CONNID = SFLIGHT~CONNID )

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.

*

*  LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*    WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-PRICE.

*  ENDLOOP.






"-----------------------------------------------------

"13. SUB QUERY - ALIAS




* DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID

*       CONNID

*       PRICE

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  WHERE CARRID IN ( SELECT CARRID

*                      FROM SPFLI

*                      WHERE CARRID = A~CARRID

*                        AND CONNID = A~CONNID )

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.

*

*  LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*    WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-PRICE.

*  ENDLOOP.






"-----------------------------------------------------

"14. JOIN - INNER






*DATA : BEGIN OF GS_RESULT,

*  ZKNAME LIKE ZEDT24_001-ZKNAME,

*  ZMNAME LIKE ZEDT24_002-ZMNAME,

*  END OF GS_RESULT.

*

*DATA : GT_RESULT LIKE TABLE OF GS_RESULT.

*

*SELECT A~ZKNAME

*       B~ZMNAME

*  INTO CORRESPONDING FIELDS OF TABLE GT_RESULT

*  FROM ZEDT24_001 AS A

*  INNER JOIN ZEDT24_002 AS B

*  ON A~ZCODE = B~ZCODE

*  WHERE A~ZCODE IN ( 'SSU-01', 'SSU-02' ).

*

*LOOP AT GT_RESULT INTO GS_RESULT.

*  WRITE :/ GS_RESULT-ZKNAME, GS_RESULT-ZMNAME.

*ENDLOOP.






"-----------------------------------------------------

"14. JOIN - OUTER



DATA : BEGIN OF GS_RESULT,

  ZKNAME LIKE ZEDT24_001-ZKNAME,

  ZMNAME LIKE ZEDT24_002-ZMNAME,

  END OF GS_RESULT.



DATA : GT_RESULT LIKE TABLE OF GS_RESULT.



BREAK-POINT.



SELECT A~ZKNAME

       B~ZMNAME

  INTO CORRESPONDING FIELDS OF TABLE GT_RESULT

  FROM ZEDT24_002 AS B

  LEFT OUTER JOIN ZEDT24_001 AS A

  ON B~ZCODE = A~ZCODE

  WHERE B~ZCODE IN ( 'SSU-01', 'SSU-02', 'SSU-27' ).



LOOP AT GT_RESULT INTO GS_RESULT.

  WRITE :/ GS_RESULT-ZKNAME, GS_RESULT-ZMNAME.

ENDLOOP.