
*&---------------------------------------------------------------------*

*& Report ZEDR06_014

*&---------------------------------------------------------------------*

*&

*&---------------------------------------------------------------------*




REPORT ZEDR06_014.




*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID CARRNAME INTO GS_SCARR

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDSELECT.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR01,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR01.

*

*DATA : GT_SCARR01 LIKE TABLE OF GS_SCARR01.

*

*SELECT SINGLE CARRID CARRNAME INTO ( GS_SCARR01-CARRID, GS_SCARR01-CARRNAME )

*  FROM SCARR

*  WHERE CARRID = 'AA'.

*

*WRITE :/ GS_SCARR01-CARRID, GS_SCARR01-CARRNAME.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AA'.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  APPENDING CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID = 'AB'.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID BETWEEN 'AA' AND 'AC'.

*

*CLEAR : GS_SCARR.

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  ZCHECK TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID LIKE 'A%'.

*

*CLEAR : GS_SCARR.

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SCARR,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN ( 'AA' , 'AC' ).

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*RANGES : GR_SCARR FOR SCARR-CARRID.

*

*CLEAR : GR_SCARR.

*

*GR_SCARR-SIGN = 'I'.

*GR_SCARR-OPTION = 'CP'.

*GR_SCARR-LOW = '*A'.

*APPEND GR_SCARR.

*

*DATA : BEGIN OF GS_SCARR.

*  INCLUDE TYPE SCARR.

*DATA : END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*SELECT * FROM SCARR INTO TABLE GT_SCARR WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*RANGES : GR_SCARR FOR SCARR-CARRID.

*

*DATA : BEGIN OF GS_SCARR,

*  ZCHEKC TYPE C,

*  CARRID LIKE SCARR-CARRID,

*  CARRNAME LIKE SCARR-CARRNAME,

*  END OF GS_SCARR.

*DATA : GT_SCARR LIKE TABLE OF GS_SCARR.

*

*GR_SCARR-SIGN = 'E'.

*GR_SCARR-OPTION = 'EQ'.

*GR_SCARR-LOW = 'AA'.

*APPEND GR_SCARR.

*

*SELECT CARRID

*       CARRNAME

*  FROM SCARR

*  INTO CORRESPONDING FIELDS OF TABLE GT_SCARR

*  WHERE CARRID IN GR_SCARR.

*

*LOOP AT GT_SCARR INTO GS_SCARR.

*  WRITE :/ GS_SCARR-CARRID, GS_SCARR-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_NUM TYPE I,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_NUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  ORDER BY GV_NUM.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_NUM.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  GV_NUM TYPE I,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID

*       CONNID

*       AVG( PRICE ) AS GV_NUM

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT GROUP BY CARRID CONNID

*  HAVING AVG( PRICE ) > 1000

*  ORDER BY GV_NUM DESCENDING.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-GV_NUM.

*ENDLOOP.



*&---------------------------------------------------------------------*

*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  PRICE TYPE SFLIGHT-PRICE,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*SELECT CARRID

*       CONNID

*       PRICE

*  FROM SFLIGHT AS S

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  WHERE CARRID IN ( SELECT CARRID

*                          FROM SPFLI

*                          WHERE CARRID = S~CARRID

*                          AND CONNID = S~CONNID )

*  AND CARRID = 'AA'

*  AND CONNID LIKE '00%'.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-PRICE.

*ENDLOOP.



*&---------------------------------------------------------------------*



*DATA : BEGIN OF GS_SFLIGHT,

*  CARRID TYPE SFLIGHT-CARRID,

*  CONNID TYPE SFLIGHT-CONNID,

*  CARRNAME TYPE SCARR-CARRNAME,

*  END OF GS_SFLIGHT.

*DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.

*

*

*SELECT A~CARRID

*       A~CONNID

*       B~CARRNAME

*  INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

*  FROM SFLIGHT AS A

*  LEFT OUTER JOIN SCARR AS B

*  ON A~CARRID = B~CARRID

*  WHERE A~CARRID = 'AA'.

*

*LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

*  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-CARRNAME.

*ENDLOOP.



*&---------------------------------------------------------------------*




DATA :BEGIN OF GS_SPFLI, " ### ## ##

  CARRID TYPE SPFLI-CARRID,

  CONNID TYPE SPFLI-CONNID,

  END OF GS_SPFLI.

DATA : GT_SPFLI LIKE TABLE OF GS_SPFLI.



DATA : BEGIN OF GS_SFLIGHT, " ### ## ## ##

  CARRID TYPE SFLIGHT-CARRID,

  CONNID TYPE SFLIGHT-CONNID,

  FLDATE TYPE SFLIGHT-FLDATE,

  PRICE TYPE SFLIGHT-PRICE,

  END OF GS_SFLIGHT.

DATA : GT_SFLIGHT LIKE TABLE OF GS_SFLIGHT.







 SELECT S~CARRID

        S~CONNID

        S~FLDATE

        S~PRICE

   FROM SFLIGHT AS S

   INTO CORRESPONDING FIELDS OF TABLE GT_SFLIGHT

   WHERE CARRID IN ( SELECT CARRID

                        FROM SPFLI AS P

                        WHERE CARRID = P~CARRID ).



LOOP AT GT_SFLIGHT INTO GS_SFLIGHT.

  WRITE :/ GS_SFLIGHT-CARRID, GS_SFLIGHT-CONNID, GS_SFLIGHT-FLDATE, GS_SFLIGHT-PRICE.

ENDLOOP.